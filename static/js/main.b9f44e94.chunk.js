(this.webpackJsonpshopper=this.webpackJsonpshopper||[]).push([[0],{102:function(e,t,n){e.exports=n(149)},107:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var i,o=n(0),a=n.n(o),r=n(7),l=n.n(r),c=(n(107),n(10)),s=n(62),u=n(61),d=n(15),m={title:"ShopperState",type:"object",properties:{selectedList:{type:"number"},lists:{type:"array",minItems:0,items:{type:"object",required:["name","items"],properties:{name:{type:"string"},items:{type:"array",minItems:0,items:{type:"object",required:["name","enabled"],properties:{name:{type:"string",minLength:1},comment:{type:"string"},enabled:{type:"boolean"}}}}}}}},additionalProperties:!1,required:["lists"]};!function(e){e[e.ADD_LIST=0]="ADD_LIST",e[e.EDIT_LIST=1]="EDIT_LIST",e[e.ADD_ITEM=2]="ADD_ITEM",e[e.EDIT_ITEM=3]="EDIT_ITEM"}(i||(i={}));var p=n(86),f=n.n(p),v="shopper-state";function b(e){var t=new f.a({allErrors:!0}).compile(m);if(t(e))return e;throw console.error("Existing state object:\n".concat(JSON.stringify(e,null,2),"\nFailed validation:\n").concat(JSON.stringify(t.errors,null,2))),Error("Invalid object")}var g=n(34),h=(n(146),g.c),E=function(){var e=Object(g.b)({enter:"Toastify__slide-enter",exit:"Toastify__slide-exit",duration:[200,200],appendPosition:!0});return a.a.createElement(g.a,{transition:e,position:"bottom-left",autoClose:2e3,hideProgressBar:!0,newestOnTop:!0,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!1,draggable:!1,pauseOnHover:!1})},y=function(e){var t=localStorage.getItem(v);return null===t?e:b(JSON.parse(t))}({selectedList:void 0,lists:[]}),O=function(e,t){return e>=0&&e<t.length},L=Object(u.b)({name:"shopper",initialState:y,reducers:{addList:function(e,t){e.dialogState=void 0;var n=t.payload,i=n.name,o=n.items;e.lists.push({name:i,items:o.map((function(e){return{name:e.name,comment:e.comment,enabled:!0}}))})},editList:function(e,t){var n=e.dialogState;if(n&&n.type===i.EDIT_LIST){var o=n.index,a=t.payload;O(o,e.lists)&&(e.lists[o].name=a,h.info("List updated."))}e.dialogState=void 0},deleteList:function(e,t){var n=t.payload;if(O(n,e.lists)){var i=e.lists.splice(n,1),o=Object(d.a)(i,1)[0];void 0===e.listUndo&&(e.listUndo=[]),e.listUndo.push(o),h.info("List deleted.")}},selectList:function(e,t){e.selectedList=t.payload},deselectList:function(e){e.selectedList=void 0,e.itemUndo=void 0},undoItemDeletion:function(e){var t=e.selectedList;if(void 0!==t&&O(t,e.lists)&&void 0!==e.itemUndo&&e.itemUndo.length>0){var n=e.itemUndo.pop();if(void 0!==n)return e.lists[t].items.push(n),void h.info("Item deletion undone.")}h.warn("Nothing to undo.")},undoListDeletion:function(e){if(void 0!==e.listUndo&&e.listUndo.length>0){var t=e.listUndo.pop();if(void 0!==t)return e.lists.push(t),void h.info("List ".concat(t.name," deletion undone."))}h.warn("Nothing to undo.")},addItem:function(e,t){e.dialogState=void 0;var n=t.payload,i=n.name,o=n.comment,a=e.selectedList;void 0!==a&&O(a,e.lists)&&e.lists[a].items.push({name:i,comment:o,enabled:!0})},editItem:function(e,t){var n=e.dialogState;if(n&&n.type===i.EDIT_ITEM){var o=n.index,a=t.payload,r=a.name,l=a.comment,c=e.selectedList,s=o;if(void 0!==c&&O(c,e.lists)&&O(s,e.lists[c].items)){var u=e.lists[c].items[s];u.name=r,u.comment=l}h.info("Item updated.")}e.dialogState=void 0},deleteItem:function(e,t){var n=e.selectedList,i=t.payload;if(void 0!==n&&O(n,e.lists)&&O(i,e.lists[n].items)){var o=e.lists[n].items.splice(i,1),a=Object(d.a)(o,1)[0];void 0===e.itemUndo&&(e.itemUndo=[]),e.itemUndo.push(a),h.info("Item deleted.")}},toggleItem:function(e,t){var n=e.selectedList,i=t.payload;if(void 0!==n&&O(n,e.lists)&&O(i,e.lists[n].items)){var o=e.lists[n].items[i];o.enabled=!o.enabled}},openAddListDialog:function(e){e.dialogState={type:i.ADD_LIST}},openEditListDialog:function(e,t){e.dialogState={type:i.EDIT_LIST,index:t.payload}},openAddItemDialog:function(e){e.dialogState={type:i.ADD_ITEM}},openEditItemDialog:function(e,t){e.dialogState={type:i.EDIT_ITEM,index:t.payload}},closeDialog:function(e){e.dialogState=void 0},copyToClipboard:function(e){var t,n;(null===(t=navigator)||void 0===t||null===(n=t.clipboard)||void 0===n?void 0:n.writeText)?(navigator.clipboard.writeText(JSON.stringify(e)),h.info("Copied to clipboard.")):h.error("ERROR: Missing clipboard browser functionality")},updateState:function(e,t){e.lists=t.payload.lists,e.selectedList=void 0}}}),C=L.actions,I=L.reducer,x=Object(u.a)({reducer:I}),D=Object(s.a)({},C,{importFromClipboard:function(){return function(e){var t,n;(null===(t=navigator)||void 0===t||null===(n=t.clipboard)||void 0===n?void 0:n.readText)?navigator.clipboard.readText().then((function(t){var n=b(JSON.parse(t));e(C.updateState(n)),h.info("Imported from clipboard")})).catch((function(e){console.log(e),h.error("ERROR: ".concat(e))})):h.error("ERROR: Missing clipboard browser functionality")}}});x.subscribe((function(){!function(e){var t=Object(s.a)({},e,{dialogState:void 0,listUndo:void 0,itemUndo:void 0});localStorage.setItem(v,JSON.stringify(t))}(x.getState())}));var k=n(194),S=n(213),T=n(197),w=n(198),j=n(30),N=n(90),_=n.n(N),U=n(190),A=n(87),M=n.n(A),R=Object(k.a)((function(e){return Object(S.a)({button:{color:"inherit"}})})),W=Object(c.b)((function(){return{}}),{openDialog:function(){return D.openAddListDialog()}})((function(e){var t=R();return a.a.createElement(U.a,{className:t.button,edge:"end",title:"Add list",color:"secondary","aria-label":"add",onClick:function(){return e.openDialog()}},a.a.createElement(M.a,null))})),B=n(88),P=n.n(B),F=Object(k.a)((function(e){return Object(S.a)({button:{color:"inherit"}})})),V=Object(c.b)((function(){return{}}),{openDialog:function(){return D.openAddItemDialog()}})((function(e){var t=F();return a.a.createElement(U.a,{className:t.button,edge:"end",title:"Add item",color:"secondary","aria-label":"add",onClick:function(){return e.openDialog()}},a.a.createElement(P.a,null))})),J=n(91),G=n(196),q=n(89),H=n.n(q),Z=function(e){var t=$(),n=a.a.useState(null),i=Object(d.a)(n,2),o=i[0],r=i[1],l=function(){r(null)};return a.a.createElement("div",null,a.a.createElement(U.a,{className:t.button,"aria-controls":"simple-menu",edge:"end","aria-label":"menu",color:"secondary","aria-haspopup":"true",onClick:function(e){r(e.currentTarget)}},a.a.createElement(H.a,null)),a.a.createElement(J.a,{anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:l},e.actions.map((function(e,t){var n=e.label,i=e.action;return a.a.createElement(G.a,{key:t,onClick:function(){l(),i()}},n)}))))},$=Object(k.a)((function(e){return Object(S.a)({button:{color:"inherit"}})})),z=Object(k.a)((function(e){return Object(S.a)({root:{flexGrow:0},title:{flexGrow:0},menuButton:{flexGrow:0},rightButton:{flexGrow:1,display:"flex",justifyContent:"flex-end",alignItems:"flex-end"}})}));var K=Object(c.b)((function(e){if(void 0!==e.selectedList){var t=e.lists[e.selectedList],n=t.name;return{selectedList:{totalItemCount:t.items.length,pendingItemCount:t.items.reduce((function(e,t){return e+Number(!!t.enabled)}),0),listName:n}}}return{selectedList:void 0}}),{deselectList:function(){return D.deselectList()},copyToClipboard:function(){return D.copyToClipboard()},importFromClipboard:function(){return D.importFromClipboard()},undoItemDeletion:function(){return D.undoItemDeletion()},undoListDeletion:function(){return D.undoListDeletion()}})((function(e){var t=z(),n="Shopper";if(e.selectedList){var i=e.selectedList,o=i.listName,r=i.pendingItemCount,l=i.totalItemCount;n=o,l>0&&(n="(".concat(r,") ").concat(n))}return a.a.createElement("div",{className:t.root},a.a.createElement(T.a,{position:"static"},a.a.createElement(w.a,null,e.selectedList&&a.a.createElement(U.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(){return e.deselectList()}},a.a.createElement(_.a,null)),a.a.createElement(j.a,{variant:"h6",className:t.title,onClick:function(){"Shopper"===n&&g.c.info("commit: c85c4a3 (2020-06-20T14:04:52.614Z)")}},n),a.a.createElement("div",{className:t.rightButton},e.selectedList?a.a.createElement(V,null):a.a.createElement(W,null)),a.a.createElement(Z,{actions:[{label:"import state from clipboard",action:function(){return e.importFromClipboard()}},{label:"copy state to clipboard",action:function(){return e.copyToClipboard()}},{label:"undo ".concat(e.selectedList?"item":"list"," deletion"),action:function(){return e.selectedList?e.undoItemDeletion():e.undoListDeletion()}}]}))))})),Q=n(195),X=n(152),Y=n(199),ee=n(200);function te(e){var t=ne(),n=e.lists.sort((function(e,t){return Number(!e.enabled)-Number(!t.enabled)}));return a.a.createElement("div",{className:t.root},a.a.createElement(Q.a,{component:"nav",className:t.list},n.map((function(n){var i=n.name,o=n.comment,r=n.enabled,l=n.index;return a.a.createElement(X.a,{style:{backgroundColor:!1!==r?"white":"gray"},key:l,button:!0,onClick:function(){return e.onClick(l)}},a.a.createElement(Y.a,{primary:i,secondary:o}),a.a.createElement(ee.a,{className:t.menuButton},a.a.createElement(Z,{actions:[{label:"edit",action:function(){return e.onEdit(l)}},{label:"delete",action:function(){return e.onDelete(l)}}]})))}))))}var ne=Object(k.a)((function(e){return Object(S.a)({root:{backgroundColor:e.palette.background.default,flex:"1",height:"90vh",display:"flex",flexDirection:"column"},list:{overflow:"scroll"},menuButton:{color:e.palette.grey[500]}})})),ie={onDelete:function(e){return D.deleteList(e)},onEdit:function(e){return D.openEditListDialog(e)},onClick:function(e){return D.selectList(e)}},oe=Object(c.b)((function(e){return{lists:e.lists.map((function(e,t){var n=e.name,i=e.items;return{name:n,comment:"".concat(i.length," items"),index:t}}))}}),ie)(te),ae=n(47),re=n.n(ae),le=n(68),ce=n(209),se=n(211),ue=n(205),de=n(212),me=n(204),pe=n(202),fe=n(203),ve=n(201),be=function(e){function t(t){t?e.onClose(!0):e.onClose(!1)}return a.a.createElement("div",null,a.a.createElement(de.a,{open:e.isOpen,onEnter:function(){e.onOpen()},onClose:function(){return t(!1)}},a.a.createElement(ve.a,null,e.title),a.a.createElement(pe.a,null,a.a.createElement(fe.a,null,e.description),e.children),a.a.createElement(me.a,null,a.a.createElement(ue.a,{onClick:function(){return t(!1)},color:"primary"},e.cancel),a.a.createElement(ue.a,{onClick:function(){return t(!0)},color:"primary",disabled:!e.isValid},e.ok))))},ge=n(206),he=/(.*) (\d+.*)/;function Ee(e){return null!==e}function ye(e){return e.split("\n").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).map((function(e){var t=e.match(he);if(!t)return null;var n=Object(d.a)(t,3);return{name:n[1],comment:n[2]}})).filter(Ee)}var Oe=function(e){return e.trim().length>0},Le=function(e){var t=Oe(e.value),n=a.a.useState(t),i=Object(d.a)(n,2),o=i[0],r=i[1],l=a.a.useState(e.value),c=Object(d.a)(l,2),s=c[0],u=c[1],m=a.a.useState({includeClipboard:!1,items:[]}),p=Object(d.a)(m,2),f=p[0],v=p[1];function b(){return g.apply(this,arguments)}function g(){return(g=Object(le.a)(re.a.mark((function e(){var t;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.readText();case 3:return t=e.sent,e.abrupt("return",ye(t));case 7:return e.prev=7,e.t0=e.catch(0),console.log("Error importing from clipboard: ".concat(e.t0)),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function h(){return(h=Object(le.a)(re.a.mark((function e(t){var n,i;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.target.checked)){e.next=7;break}return e.next=4,b();case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=[];case 8:i=e.t0,v({includeClipboard:n,items:i});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=f.includeClipboard?"".concat(f.items.length," "):" ",y="Include ".concat(E,"items from clipboard");return a.a.createElement(be,{isOpen:e.isOpen,isValid:o,onOpen:function(){u(e.value),r(Oe(e.value)),v({includeClipboard:!1,items:[]})},onClose:function(t){t?e.onClose({name:s,items:f.includeClipboard?f.items:[]}):e.onClose()},title:e.title,description:e.descriptionText,ok:"ok",cancel:"cancel"},a.a.createElement(ce.a,{error:!o,autoFocus:!0,margin:"dense",label:"List name",type:"text",onChange:function(e){var t=e.target.value;u(t),r(Oe(t))},fullWidth:!0,value:s,InputLabelProps:{shrink:!0}}),!e.isEdit&&a.a.createElement(ge.a,{control:a.a.createElement(se.a,{checked:f.includeClipboard,onChange:function(e){return h.apply(this,arguments)},color:"primary"}),label:y}))},Ce=Object(c.b)((function(e){var t;return{isOpen:(null===(t=e.dialogState)||void 0===t?void 0:t.type)===i.ADD_LIST}}),{onClose:function(e){return e?D.addList(e):D.closeDialog()}})((function(e){return a.a.createElement(Le,Object.assign({value:"",title:"Create List",okText:"Create",isEdit:!1,descriptionText:"Pick the name for your new list."},e))})),Ie=function(e){return{name:e.name.trim().length>0,comment:!0}},xe=function(e){var t=Ie(e.value),n=a.a.useState(t),i=Object(d.a)(n,2),o=i[0],r=i[1],l=a.a.useState(e.value),c=Object(d.a)(l,2),s=c[0],u=c[1];return a.a.createElement("div",null,a.a.createElement(be,{isOpen:e.isOpen,description:e.descriptionText,isValid:o.name&&o.comment,onOpen:function(){u(e.value),r(Ie(e.value))},onClose:function(t){t?e.onClose(s):e.onClose()},title:e.title,ok:"ok",cancel:"cancel"},a.a.createElement(ce.a,{error:!o.name,autoFocus:!0,margin:"dense",label:"Item name",placeholder:"What's the name of the item?",type:"text",onChange:function(e){var t={name:e.target.value,comment:s.comment};u(t),r(Ie(t))},fullWidth:!0,value:s.name,InputLabelProps:{shrink:!0}}),a.a.createElement(ce.a,{error:!o.comment,margin:"dense",label:"Comment (optional)",placeholder:"How many of this item?",value:s.comment,onChange:function(e){var t={name:s.name,comment:e.target.value};u(t),r(Ie(t))},type:"text",fullWidth:!0,InputLabelProps:{shrink:!0}})))},De={name:"",comment:""},ke=Object(c.b)((function(e){var t;return{isOpen:(null===(t=e.dialogState)||void 0===t?void 0:t.type)===i.ADD_ITEM}}),{onClose:function(e){return e?D.addItem(e):D.closeDialog()}})((function(e){return a.a.createElement(xe,Object.assign({value:De,title:"Create Item",okText:"Create",descriptionText:"Pick the name for your new item."},e))})),Se=Object(c.b)((function(e){var t=e.dialogState;return(null===t||void 0===t?void 0:t.type)===i.EDIT_LIST&&t.index>=0&&t.index<e.lists.length?{isOpen:!0,initialValue:e.lists[t.index].name}:{isOpen:!1,initialValue:""}}),{onClose:function(e){return e?D.editList(e):D.closeDialog()}})((function(e){return a.a.createElement(Le,Object.assign({value:e.initialValue,title:"Edit List",okText:"Update",isEdit:!0,descriptionText:"Pick the name for your list."},e,{onClose:function(t){return t?e.onClose(t.name):e.onClose()}}))})),Te=Object(c.b)((function(e){var t=e.dialogState,n=e.selectedList;return void 0!==n&&n>=0&&n<e.lists.length&&(null===t||void 0===t?void 0:t.type)===i.EDIT_ITEM&&t.index>=0&&t.index<e.lists[n].items.length?{isOpen:!0,initialValue:e.lists[n].items[t.index]}:{isOpen:!1,initialValue:{name:"",comment:""}}}),{onClose:function(e){return e?D.editItem(e):D.closeDialog()}})((function(e){return a.a.createElement(xe,Object.assign({value:e.initialValue,title:"Edit List",okText:"Update",descriptionText:"Pick the name for your list."},e))})),we={onDelete:function(e){return D.deleteItem(e)},onEdit:function(e){return D.openEditItemDialog(e)},onClick:function(e){return D.toggleItem(e)}},je=Object(c.b)((function(e){var t=e.selectedList;return void 0!==t?{lists:e.lists[t].items.map((function(e,t){return{name:e.name,comment:e.comment,enabled:e.enabled,index:t}}))}:{lists:[]}}),we)(te);var Ne=Object(c.b)((function(e){return{isListSelected:void 0!==e.selectedList}}))((function(e){var t=e.isListSelected;return a.a.createElement("div",{style:{flex:1,display:"flex",flexFlow:"column",height:"100%"}},a.a.createElement(K,null),t?a.a.createElement(je,null):a.a.createElement(oe,null),t?a.a.createElement(ke,null):a.a.createElement(Ce,null),t?a.a.createElement(Te,null):a.a.createElement(Se,null),a.a.createElement(E,null))})),_e=n(207),Ue=n(208),Ae=Object(_e.a)({props:{MuiButtonBase:{disableRipple:!0}},transitions:{create:function(){return"none"}}}),Me=Object(k.a)((function(e){return Object(S.a)({app:{minHeight:"100vh",height:"100%",display:"flex",overflow:"hidden",flexDirection:"column"}})})),Re=function(){var e=Me();return a.a.createElement(Ue.a,{theme:Ae},a.a.createElement("div",{className:e.app},a.a.createElement(Ne,null)))},We=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Be(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(c.a,{store:x},a.a.createElement(Re,null))),document.getElementById("root")),function(){var e=new URL(window.location.href).searchParams.get("debug");return Boolean(e)}()?(console.log("No service worker enabled."),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))):function(e){if("serviceWorker"in navigator){if(new URL("/shopper",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/shopper","/service-worker.js");We?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Be(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Be(t,e)}))}}()}},[[102,1,2]]]);
//# sourceMappingURL=main.b9f44e94.chunk.js.map