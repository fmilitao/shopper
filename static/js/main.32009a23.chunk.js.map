{"version":3,"sources":["shopper/redux/state.ts","shopper/redux/localStorage.ts","shopper/components/common/Notifier.tsx","shopper/redux/id.ts","shopper/components/google-sheets/gsheets-serde.ts","shopper/importer.ts","shopper/components/google-sheets/spreadsheet.ts","shopper/redux/slice.ts","shopper/history.ts","shopper/redux/store.ts","shopper/components/shopping-list/AddButton.tsx","shopper/components/shopping-list/AddButtonContainer.tsx","shopper/components/item-list/AddButton.tsx","shopper/components/item-list/AddButtonContainer.tsx","shopper/components/common/Menu.tsx","shopper/components/google-sheets/SheetControl.tsx","shopper/components/app-bar/AppBar.tsx","shopper/components/app-bar/AppBarContainer.tsx","version.ts","shopper/components/common/ContextMenu.tsx","shopper/components/common/List.tsx","shopper/components/shopping-list/ListContainer.tsx","shopper/components/common/Dialog.tsx","shopper/components/shopping-list/GenericDialog.tsx","shopper/components/shopping-list/AddDialogContainer.tsx","shopper/components/shopping-list/AddDialog.tsx","shopper/components/common/Select.tsx","shopper/components/item-list/GenericDialog.tsx","shopper/components/item-list/AddDialog.tsx","shopper/components/item-list/AddDialogContainer.tsx","shopper/components/shopping-list/EditDialogContainer.tsx","shopper/components/shopping-list/EditDialog.tsx","shopper/components/item-list/EditDialogContainer.tsx","shopper/components/item-list/EditDialog.tsx","shopper/components/google-sheets/SetupDialog.tsx","shopper/components/google-sheets/SetupDialogContainer.tsx","shopper/components/common/Colors.ts","shopper/components/item-list/ListContainer.tsx","shopper/components/Main.tsx","shopper/App.tsx","serviceWorker.ts","index.tsx"],"names":["DialogType","GoogleSheetSchema","type","required","properties","spreadsheetId","minLength","range","clientId","apiKey","ShopperStateSchema","title","selectedList","sortMode","enum","itemClick","googleSheetActions","categoryMode","categoryColorMapper","patternProperties","additionalProperties","googleSheets","lists","minItems","items","id","name","comment","enabled","category","validate","obj","test","Ajv","allErrors","compile","schema","console","error","JSON","stringify","errors","Error","logger","toast","transition","cssTransition","enter","exit","duration","appendPosition","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","timestamp","Date","now","toString","counter","newId","prefix","newItemId","deserialize","values","internal","headers","normalized","map","row","reduce","accumulator","key","i","undefined","filter","elem","startsWith","list","item","listId","settings","Object","fromEntries","text","parse","value","serialize","state","simplify","simplifierCounter","Map","simplifierMap","simplifyListId","has","get","count","simplerId","set","normalizedLists","normalizedItems","flatMap","Array","from","curr","keys","add","Set","x","h","unshift","validKeys","entries","stringWithCheckbox","stringWithCommentAtTheEnd","stringWithQuantityAtTheStart","notNull","importText","rawText","split","txt","trim","length","withCheckbox","match","rest","maybeCheckbox","matchWithQuantityAtTheStart","matchCommentAtTheEnd","maybeComment","exportText","checkbox","cleanedComment","join","discoveryDocs","scope","init","isOnline","setSignIn","loaded","setSignInStatus","initClient","a","gapi","client","auth2","getAuthInstance","isSignedIn","listen","log","script","document","createElement","src","onload","load","body","appendChild","loadGApi","batchUpdate","sheets","spreadsheets","valueInputOption","data","batchClear","ranges","getValues","response","result","isInBounds","index","array","shopperSlice","createSlice","initialState","defaultValue","raw","localStorage","getItem","loadOrDefault","reducers","setDefaultSort","setCategorySort","setAlphabeticSort","toggleItemClick","toggleGoogleSheetActions","setTextCategoryMode","setHiddenCategoryMode","setColorCategoryMode","addList","action","payload","push","editList","dialogState","EDIT_LIST","info","deleteList","splice","deleted","listUndo","selectList","deselectList","itemUndo","undoItemDeletion","listIndex","undo","pop","warn","undoListDeletion","addItem","editItem","EDIT_ITEM","newListIndex","itemIndex","moved","deleteItem","toggleItem","openAddListDialog","ADD_LIST","openEditListDialog","openAddItemDialog","ADD_ITEM","openEditItemDialog","openSetupGoogleSheetsDialog","SETUP_GOOGLE_SHEETS","closeDialog","copyToClipboard","navigator","clipboard","writeText","copyItemsToClipboard","updateState","assign","setGoogleSheetsLoggedIn","googleSheetsLoggedIn","setGoogleSheetsDetails","actions","reducer","dequeueIfNeeded","isShopperQueued","isListSelected","window","history","back","enqueueIfNeeded","pushState","store","configureStore","sliceActions","importFromClipboard","dispatch","readText","then","catch","importFromGoogleSheets","getState","sheet","copyToGoogleSheet","_","addItemsFromClipboard","clonedState","fullItems","subscribe","shallowClone","setItem","save","isQueued","useStyles","makeStyles","theme","createStyles","button","color","connector","connect","openDialog","props","classes","IconButton","className","edge","aria-label","onClick","React","useState","anchorEl","setAnchorEl","handleClose","aria-controls","aria-haspopup","event","currentTarget","children","Menu","keepMounted","open","Boolean","onClose","actionList","outerIndex","innerIndex","label","selected","MenuItem","Divider","status","setLoginStatus","useEffect","icon","size","root","flexGrow","menuButton","rightButton","display","justifyContent","alignItems","listName","totalItemCount","pendingItemCount","prev","Number","googleSheetsEnabled","itemActions","itemClickToggle","googleSheetsActions","sortActions","onLine","setIsOnline","addEventListener","AppBar","Toolbar","Typography","variant","anchorPosition","top","y","left","anchorReference","mouse","useRef","time","handleMouseDown","e","current","screenX","handleMouseClick","Math","abs","preventDefault","clickEnabled","onChangeIndex","start","onDelete","setState","handleOpenContextMenu","clientX","clientY","Wrapper","forwardRef","ref","ContextMenu","List","component","enterAnimation","leaveAnimation","arrayIndex","panels","ListItem","enabledItem","disabledItem","style","backgroundColor","extractColor","onContextMenu","onMouseDown","ListItemText","primary","secondary","rightPanel","swipeRight","leftPanel","startIndex","paddingBottom","enableMouseEvents","height","direction","marginRight","marginLeft","palette","background","default","flex","flexDirection","overflowY","overflowX","minHeight","userSelect","textDecoration","opacity","grey","dispatchToProps","onEdit","useDispatch","commit","onOpen","Dialog","fullScreen","isOpen","onEnter","DialogActions","another","Button","disabled","isValid","cancel","ok","DialogTitle","DialogContent","DialogContentText","description","newValue","initialCheck","isValidCheck","setValidCheck","tmpValue","setTmpValue","includeClipboard","setIncludeClipboard","target","checked","allowedImport","defaultFocus","focus","onCommit","descriptionText","okText","anotherText","cancelText","TextField","inputRef","input","margin","onChange","fullWidth","InputLabelProps","shrink","isEdit","FormControlLabel","control","Checkbox","Select","marginTop","InputLabel","htmlFor","NativeSelect","selectedIndex","choices","choice","tmpList","setTmpList","showText","setShowText","noCategories","categories","notInCategoryList","indexOf","showDialogText","placeholder","handleCategoryIndexChange","autoFocus","listOptions","initialValue","extractCategories","forEach","helperText","marginBottom","setSpreadsheetId","setRange","setClientId","setApiKey","validApiKey","validClientId","validRange","validSpreadsheetId","password","encrypted","configFile","decrypted","CryptoJS","AES","decrypt","enc","Utf8","ajv","slice","COLORS","defaultSorter","b","alphabeticSorter","defaultResult","aName","bName","localeCompare","categorySorter","aCategory","bCategory","toggleClick","sorter","buildMapper","sort","flexFlow","Notifier","createMuiTheme","MuiButtonBase","disableRipple","transitions","create","app","overflow","ThemeProvider","isLocalhost","location","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","URL","href","searchParams","ReactDOM","render","StrictMode","App","getElementById","param","isDebug","ready","unregister","message","process","origin","fetch","contentType","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.32009a23.chunk.js","sourcesContent":["import { ThunkAction, Action } from '@reduxjs/toolkit';\n\nconst SORT_MODES = ['default', 'categories', 'alphabetic'] as const;\nexport type SortMode = typeof SORT_MODES[number];\n\nconst CATEGORY_MODES = ['text', 'color', 'hidden'] as const;\nexport type CategoryMode = typeof CATEGORY_MODES[number];\n\nexport interface Category {\n  name: string;\n}\n\nexport interface Item {\n  id: string;\n  name: string;\n  comment: string;\n  enabled: boolean;\n  category?: string;\n}\n\nexport type SimpleItem = Omit<Item, 'enabled' | 'id'>;\n\nconst ItemSchema = {\n  type: 'object',\n  required: ['id', 'name', 'enabled'],\n  properties: {\n    id: {\n      type: 'string',\n      minLength: 1,\n    },\n    name: {\n      type: 'string',\n      minLength: 1,\n    },\n    comment: {\n      type: 'string',\n    },\n    enabled: {\n      type: 'boolean',\n    },\n    category: {\n      type: 'string',\n      minLength: 1,\n    },\n  },\n};\n\nexport interface List {\n  id: string;\n  name: string;\n  items: Item[];\n}\n\nconst ListSchema = {\n  type: 'object',\n  required: ['id', 'name', 'items'],\n  properties: {\n    id: {\n      type: 'string',\n      minLength: 1,\n    },\n    name: {\n      type: 'string',\n      minLength: 1,\n    },\n    items: {\n      type: 'array',\n      minItems: 0,\n      items: ItemSchema,\n    },\n  },\n};\n\nexport const GoogleSheetSchema = {\n  type: 'object',\n  required: ['spreadsheetId', 'range', 'clientId', 'apiKey'],\n  properties: {\n    spreadsheetId: {\n      type: 'string',\n      minLength: 1,\n    },\n    range: {\n      type: 'string',\n      minLength: 1,\n    },\n    clientId: {\n      type: 'string',\n      minLength: 1,\n    },\n    apiKey: {\n      type: 'string',\n      minLength: 1,\n    },\n  },\n};\n\nexport interface ShopperState {\n  selectedList?: number;\n  sortMode: SortMode;\n  itemClick: boolean;\n  googleSheetActions: boolean;\n  categoryMode: CategoryMode;\n  categoryColorMapper?: {\n    [category: string]: string;\n  };\n  lists: List[];\n  googleSheets?: {\n    spreadsheetId: string;\n    range: string;\n    clientId: string;\n    apiKey: string;\n  };\n  // not in schema\n  dialogState?: DialogState;\n  listUndo?: List[];\n  itemUndo?: Item[];\n  googleSheetsLoggedIn?: boolean;\n}\n\nexport const ShopperStateSchema = {\n  title: 'ShopperState',\n  type: 'object',\n  properties: {\n    selectedList: {\n      type: 'number',\n    },\n    sortMode: { type: 'string', enum: SORT_MODES },\n    itemClick: { type: 'boolean' },\n    googleSheetActions: { type: 'boolean' },\n    categoryMode: { type: 'string', enum: CATEGORY_MODES },\n    categoryColorMapper: {\n      type: 'object',\n      patternProperties: {\n        // any key must be a string\n        '^.*$': {\n          type: 'string',\n        },\n      },\n      additionalProperties: false,\n    },\n    googleSheets: GoogleSheetSchema,\n    lists: {\n      type: 'array',\n      minItems: 0,\n      items: ListSchema,\n    },\n  },\n  additionalProperties: false,\n  required: ['lists', 'categoryMode', 'sortMode'],\n};\n\n// not in schema\nexport enum DialogType {\n  ADD_LIST,\n  EDIT_LIST,\n  ADD_ITEM,\n  EDIT_ITEM,\n  SETUP_GOOGLE_SHEETS,\n}\n\nexport interface AddListDialog {\n  type: DialogType.ADD_LIST;\n}\nexport interface AddItemDialog {\n  type: DialogType.ADD_ITEM;\n}\n\nexport interface EditListDialog {\n  type: DialogType.EDIT_LIST;\n  index: number;\n}\n\nexport interface EditItemDialog {\n  type: DialogType.EDIT_ITEM;\n  index: number;\n}\nexport interface SetupGoogleSheetsDialog {\n  type: DialogType.SETUP_GOOGLE_SHEETS;\n}\n\nexport type DialogState =\n  | SetupGoogleSheetsDialog\n  | AddListDialog\n  | AddItemDialog\n  | EditListDialog\n  | EditItemDialog;\n\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  ShopperState,\n  unknown,\n  Action<string>\n>;\n","import Ajv from 'ajv';\n\nimport type { ShopperState } from './state';\nimport { ShopperStateSchema as schema } from './state';\n\nconst key = 'shopper-state';\n\nexport function validate(obj: unknown): ShopperState {\n  const ajv = new Ajv({ allErrors: true });\n  const test = ajv.compile(schema);\n  if (test(obj)) {\n    return obj as ShopperState;\n  }\n  console.error(`Existing state object:\n${JSON.stringify(obj, null, 2)}\nFailed validation:\n${JSON.stringify(test.errors, null, 2)}`);\n\n  throw Error('Invalid object');\n}\n\nexport function load(defaultValue: ShopperState): ShopperState {\n  const raw = localStorage.getItem(key);\n  if (raw === null) {\n    return defaultValue;\n  }\n  const object = JSON.parse(raw);\n  return validate(object);\n}\n\nexport function save(state: ShopperState) {\n  const shallowClone = {\n    ...state,\n    // ensure not saved\n    dialogState: undefined,\n    listUndo: undefined,\n    itemUndo: undefined,\n    googleSheetsLoggedIn: undefined,\n  };\n  localStorage.setItem(key, JSON.stringify(shallowClone));\n}\n","import React from 'react';\nimport { ToastContainer, cssTransition, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nexport const logger = toast;\n\nexport default function () {\n  // copied from Slide to change durations\n  // https://github.com/fkhadra/react-toastify/blob/da5fab4006456434d7ad29360aa702d2c725a9a1/src/components/Transitions.tsx\n  const transition = cssTransition({\n    enter: `Toastify__slide-enter`,\n    exit: `Toastify__slide-exit`,\n    duration: [200, 200],\n    appendPosition: true,\n  });\n\n  // TODO: more customization?\n  // https://github.com/fkhadra/react-toastify/issues/455\n\n  return (\n    <ToastContainer\n      transition={transition}\n      position=\"bottom-left\"\n      autoClose={2000}\n      hideProgressBar={true}\n      newestOnTop={true}\n      closeOnClick={false}\n      rtl={false}\n      pauseOnFocusLoss={false}\n      draggable={false}\n      pauseOnHover={false}\n    />\n  );\n}\n","const timestamp = Date.now().toString(36);\nlet counter = 0;\n\nexport default function newId(prefix: string) {\n  return `${prefix}(${timestamp}:${counter++})`;\n}\n\nexport const LIST_ID_PREFIX = 'list-id';\nexport const ITEM_ID_PREFIX = 'item-id';\n\nexport const newListId = () => newId(LIST_ID_PREFIX);\nexport const newItemId = () => newId(ITEM_ID_PREFIX);\n","import { ITEM_ID_PREFIX, LIST_ID_PREFIX } from '../../redux/id';\nimport { validate } from '../../redux/localStorage';\nimport { ShopperState } from '../../redux/state';\n\nexport function deserialize(values: string[][]): ShopperState {\n  const [internal, headers, ...others] = values;\n  const normalized = others.map((row: string[]) =>\n    headers.reduce((accumulator: any, key: string, i: number) => {\n      if (row[i] !== undefined && row[i] !== '') {\n        accumulator[key] = row[i];\n        // special parsing for boolean entry\n        if (key === 'enabled') {\n          accumulator[key] = accumulator[key] === 'true';\n        }\n      }\n      return accumulator;\n    }, {})\n  );\n  const lists = normalized\n    .filter(elem => elem.id.startsWith(LIST_ID_PREFIX))\n    .map(list => {\n      list.items = normalized\n        .filter(\n          item => item.id.startsWith(ITEM_ID_PREFIX) && item.listId === list.id\n        )\n        .map(item => {\n          delete item.listId;\n          return item;\n        });\n      return list;\n    });\n\n  const settings = Object.fromEntries(\n    internal.map(text => JSON.parse(text)).map(({ key, value }) => [key, value])\n  );\n\n  return validate({\n    lists,\n    ...settings,\n  });\n}\n\nexport function serialize(state: ShopperState, simplify: boolean): string[][] {\n  const simplifierCounter = new Map<string, number>();\n  const simplifierMap = new Map<string, string>();\n  const simplifyListId = simplify\n    ? (id: string, prefix: string) => {\n        if (simplifierMap.has(id)) {\n          return simplifierMap.get(id);\n        }\n        const count = (simplifierCounter.get(prefix) ?? 0) + 1;\n        const simplerId = `${prefix}-${count}`;\n        simplifierCounter.set(prefix, count);\n        simplifierMap.set(id, simplerId);\n        return simplerId;\n      }\n    : (id: string) => id;\n\n  const normalizedLists = state.lists.map(list => ({\n    id: simplifyListId(list.id, LIST_ID_PREFIX),\n    name: list.name,\n  }));\n\n  const normalizedItems = state.lists.flatMap(list =>\n    list.items.map(item => ({\n      listId: simplifyListId(list.id, LIST_ID_PREFIX),\n      ...item,\n      id: simplifyListId(item.id, ITEM_ID_PREFIX),\n    }))\n  );\n\n  const normalized = [...normalizedLists, ...normalizedItems];\n\n  // collect all headers\n  const headers = Array.from(\n    normalized.reduce((set, curr) => {\n      Object.keys(curr).map(key => set.add(key));\n      return set;\n    }, new Set<string>())\n  );\n\n  // leave empty for undefined\n  const values = normalized.map((x: any) =>\n    headers.map(h => (x[h] === undefined ? '' : `${x[h]}`))\n  );\n\n  values.unshift(headers);\n\n  const validKeys = new Set([\n    'sortMode',\n    'itemClick',\n    'categoryMode',\n    'categoryColorMapper',\n  ]);\n\n  const settings = Object.entries(state)\n    // don't handle .lists as settings since we already serialized it\n    .filter(([key, _value]) => validKeys.has(key))\n    .map(([key, value]) => JSON.stringify({ key, value }));\n\n  values.unshift(settings);\n\n  return values;\n}\n","const stringWithCheckbox = /(\\[.{1,1}\\]) (.*)/;\nconst stringWithCommentAtTheEnd = /(.*) (\\d+.*)/;\nconst stringWithQuantityAtTheStart = /(\\d+)[Xx] (.*)/;\n\nfunction notNull<T>(value: T | null): value is T {\n  return value !== null;\n}\n\nfunction maybeCheckbox(txt: string) {\n  const withCheckbox = txt.match(stringWithCheckbox);\n  if (withCheckbox !== null) {\n    const [, checkboxText, rest] = withCheckbox;\n    const enabled = '[ ]' === checkboxText;\n    return { enabled, rest };\n  }\n  return { enabled: true, rest: txt };\n}\n\nfunction maybeComment(txt: string) {\n  const matchWithQuantityAtTheStart = txt.match(stringWithQuantityAtTheStart);\n  if (matchWithQuantityAtTheStart !== null) {\n    const [, comment, name] = matchWithQuantityAtTheStart;\n    return { name, comment };\n  }\n  const matchCommentAtTheEnd = txt.match(stringWithCommentAtTheEnd);\n  if (matchCommentAtTheEnd !== null) {\n    const [, name, comment] = matchCommentAtTheEnd;\n    return { name, comment };\n  }\n  return { name: txt, comment: '' };\n}\n\nexport function importText(\n  rawText: string\n): { name: string; comment: string; enabled: boolean }[] {\n  return rawText\n    .split('\\n')\n    .map(txt => txt.trim())\n    .filter(txt => txt.length > 0)\n    .map(txt => {\n      const { enabled, rest } = maybeCheckbox(txt);\n      const { name, comment } = maybeComment(rest);\n      return { name, comment, enabled };\n    })\n    .filter(notNull);\n}\n\nexport function exportText(\n  items: { name: string; comment: string; enabled: boolean }[]\n): string {\n  return items\n    .map(({ name, comment, enabled }) => {\n      const checkbox = enabled ? '[ ]' : '[X]';\n      const cleanedComment = comment.length !== 0 ? ` ${comment}` : comment;\n      return `${checkbox} ${name}${cleanedComment}`;\n    })\n    .join('\\n');\n}\n","/* global gapi */\n\nimport { deserialize } from './gsheets-serde';\n\n// Array of API discovery doc URLs for APIs\nconst discoveryDocs = [\n  'https://sheets.googleapis.com/$discovery/rest?version=v4',\n];\n\n// Authorization scopes required by the API; multiple scopes can be\n// included, separated by spaces.\n// https://developers.google.com/sheets/api/guides/authorizing\nconst scope = 'https://www.googleapis.com/auth/spreadsheets';\n\nexport function init(\n  apiKey: string | undefined,\n  clientId: string | undefined,\n  isOnline: boolean,\n  setSignIn: (isSignedIn: boolean) => void\n) {\n  if (\n    isOnline &&\n    apiKey !== undefined &&\n    clientId !== undefined &&\n    !init.loaded\n  ) {\n    init.loaded = true;\n    loadGApi(apiKey, clientId, setSignIn);\n  }\n}\ninit.loaded = false;\n\nexport function loadGApi(\n  apiKey: string,\n  clientId: string,\n  setSignInStatus: (status: boolean) => void\n) {\n  function handleClientLoad() {\n    gapi.load('client:auth2', initClient);\n  }\n\n  async function initClient() {\n    try {\n      await gapi.client.init({\n        apiKey,\n        clientId,\n        discoveryDocs,\n        scope,\n      });\n\n      // Listen for sign-in state changes.\n      gapi.auth2.getAuthInstance().isSignedIn.listen(setSignInStatus);\n\n      // Handle the initial sign-in state.\n      setSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());\n    } catch (error) {\n      console.log(JSON.stringify(error, null, 2));\n      setSignInStatus(false);\n    }\n  }\n\n  const script = document.createElement('script');\n  script.src = 'https://apis.google.com/js/client.js';\n  script.onload = () => handleClientLoad();\n  document.body.appendChild(script);\n}\n\nexport function handleSignIn() {\n  gapi.auth2.getAuthInstance().signIn();\n}\n\nexport function handleSignOut() {\n  gapi.auth2.getAuthInstance().signOut();\n}\n\nexport async function getSpreadsheetTitle(spreadsheetId: string) {\n  const response = await gapi.client.sheets.spreadsheets.get({\n    spreadsheetId,\n  });\n  return String(response.result.properties.title);\n}\n\nexport async function batchUpdate(\n  spreadsheetId: string,\n  range: string,\n  values: string[][]\n) {\n  try {\n    return await gapi.client.sheets.spreadsheets.values.batchUpdate(\n      {\n        spreadsheetId,\n      },\n      {\n        // valueInputOption: 'USER_ENTERED',\n        valueInputOption: 'RAW',\n        data: {\n          range,\n          values,\n        },\n      }\n    );\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/batchClear\nexport async function batchClear(spreadsheetId: string, range: string) {\n  return await gapi.client.sheets.spreadsheets.values.batchClear(\n    {\n      spreadsheetId,\n    },\n    {\n      ranges: range,\n    }\n  );\n}\n\nexport async function getValues(spreadsheetId: string, range: string) {\n  const response = await gapi.client.sheets.spreadsheets.values.get({\n    spreadsheetId,\n    range,\n  });\n\n  return deserialize(response.result.values);\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { ShopperState, DialogType, AppThunk } from './state';\nimport { load, validate } from './localStorage';\nimport { logger } from '../components/common/Notifier';\nimport { newListId, newItemId } from './id';\nimport { serialize } from '../components/google-sheets/gsheets-serde';\nimport { importText, exportText } from '../importer';\nimport {\n  batchClear,\n  batchUpdate,\n  getValues,\n} from '../components/google-sheets/spreadsheet';\n\nfunction loadOrDefault(): ShopperState {\n  const defaultValue: ShopperState = {\n    selectedList: undefined,\n    sortMode: 'default',\n    itemClick: false,\n    googleSheetActions: false,\n    categoryMode: 'text',\n    lists: [],\n  };\n\n  try {\n    return load(defaultValue);\n  } catch (error) {\n    logger.error(`Failed to load local state: ${error}`);\n  }\n  return defaultValue;\n}\n\nconst isInBounds = <T>(index: number, array: T[]) =>\n  index >= 0 && index < array.length;\n\nexport const shopperSlice = createSlice({\n  name: 'shopper',\n  initialState: loadOrDefault(),\n  reducers: {\n    // sort\n    setDefaultSort: state => {\n      state.sortMode = 'default';\n    },\n    setCategorySort: state => {\n      state.sortMode = 'categories';\n    },\n    setAlphabeticSort: state => {\n      state.sortMode = 'alphabetic';\n    },\n    // item click\n    toggleItemClick: state => {\n      state.itemClick = !state.itemClick;\n    },\n    toggleGoogleSheetActions: state => {\n      state.googleSheetActions = !state.googleSheetActions;\n    },\n    // category\n    setTextCategoryMode: state => {\n      state.categoryMode = 'text';\n    },\n    setHiddenCategoryMode: state => {\n      state.categoryMode = 'hidden';\n    },\n    setColorCategoryMode: state => {\n      state.categoryMode = 'color';\n    },\n    // list\n    addList: (\n      state,\n      action: PayloadAction<{\n        name: string;\n        items: { name: string; comment: string; enabled: boolean }[];\n      }>\n    ) => {\n      const { name, items } = action.payload;\n      state.lists.push({\n        id: newListId(),\n        name,\n        items: items.map(({ name, comment, enabled }) => ({\n          id: newItemId(),\n          name,\n          comment,\n          enabled,\n        })),\n      });\n    },\n    editList: (state, action: PayloadAction<string>) => {\n      const { dialogState } = state;\n      if (dialogState && dialogState.type === DialogType.EDIT_LIST) {\n        const { index } = dialogState;\n        const name = action.payload;\n        if (isInBounds(index, state.lists)) {\n          state.lists[index].name = name;\n          logger.info('List updated');\n        }\n      }\n    },\n    deleteList: (state, action: PayloadAction<number>) => {\n      const index = action.payload;\n      if (isInBounds(index, state.lists)) {\n        const [deleted] = state.lists.splice(index, 1);\n\n        if (state.listUndo === undefined) {\n          state.listUndo = [];\n        }\n        state.listUndo.push(deleted);\n\n        logger.info(`List \"${deleted.name}\" deleted`);\n      }\n    },\n    selectList: (state, action: PayloadAction<number>) => {\n      state.selectedList = action.payload;\n    },\n    deselectList: state => {\n      state.selectedList = undefined;\n      state.itemUndo = undefined;\n    },\n    // undo\n    undoItemDeletion: state => {\n      const listIndex = state.selectedList;\n      if (\n        listIndex !== undefined &&\n        isInBounds(listIndex, state.lists) &&\n        state.itemUndo !== undefined &&\n        state.itemUndo.length > 0\n      ) {\n        const undo = state.itemUndo.pop();\n        if (undo !== undefined) {\n          state.lists[listIndex].items.push(undo);\n          logger.info('Item restored');\n          return;\n        }\n      }\n      logger.warn('Nothing to undo');\n    },\n    undoListDeletion: state => {\n      if (state.listUndo !== undefined && state.listUndo.length > 0) {\n        const undo = state.listUndo.pop();\n        if (undo !== undefined) {\n          state.lists.push(undo);\n          logger.info(`List \"${undo.name}\" restored`);\n          return;\n        }\n      }\n      logger.warn('Nothing to undo');\n    },\n    // item\n    addItem: (\n      state,\n      action: PayloadAction<{\n        name: string;\n        comment: string;\n        category?: string;\n      }>\n    ) => {\n      const { name, comment, category } = action.payload;\n      const listIndex = state.selectedList;\n      if (listIndex !== undefined && isInBounds(listIndex, state.lists)) {\n        state.lists[listIndex].items.push({\n          id: newItemId(),\n          name,\n          comment,\n          enabled: true,\n          category,\n        });\n      }\n    },\n    editItem: (\n      state,\n      action: PayloadAction<{\n        name: string;\n        comment: string;\n        listIndex?: number;\n        category?: string;\n      }>\n    ) => {\n      const { dialogState } = state;\n      if (dialogState && dialogState.type === DialogType.EDIT_ITEM) {\n        const { index } = dialogState;\n        const {\n          name,\n          comment,\n          listIndex: newListIndex,\n          category,\n        } = action.payload;\n\n        const listIndex = state.selectedList;\n        const itemIndex = index;\n        if (\n          listIndex !== undefined &&\n          isInBounds(listIndex, state.lists) &&\n          isInBounds(itemIndex, state.lists[listIndex].items)\n        ) {\n          const item = state.lists[listIndex].items[itemIndex];\n          item.name = name;\n          item.comment = comment;\n          item.category = category;\n\n          if (\n            newListIndex !== undefined &&\n            listIndex !== newListIndex &&\n            isInBounds(newListIndex, state.lists)\n          ) {\n            const [moved] = state.lists[listIndex].items.splice(itemIndex, 1);\n            state.lists[newListIndex].items.push(moved);\n            logger.info('Item moved');\n          } else {\n            logger.info('Item updated');\n          }\n        }\n      }\n    },\n    deleteItem: (state, action: PayloadAction<number>) => {\n      const listIndex = state.selectedList;\n      const itemIndex = action.payload;\n      if (\n        listIndex !== undefined &&\n        isInBounds(listIndex, state.lists) &&\n        isInBounds(itemIndex, state.lists[listIndex].items)\n      ) {\n        const [deleted] = state.lists[listIndex].items.splice(itemIndex, 1);\n\n        if (state.itemUndo === undefined) {\n          state.itemUndo = [];\n        }\n        state.itemUndo.push(deleted);\n\n        logger.info('Item deleted');\n      }\n    },\n    toggleItem: (state, action: PayloadAction<number>) => {\n      const listIndex = state.selectedList;\n      const itemIndex = action.payload;\n      if (\n        listIndex !== undefined &&\n        isInBounds(listIndex, state.lists) &&\n        isInBounds(itemIndex, state.lists[listIndex].items)\n      ) {\n        const item = state.lists[listIndex].items[itemIndex];\n        item.enabled = !item.enabled;\n      }\n    },\n    // dialog\n    openAddListDialog: state => {\n      state.dialogState = {\n        type: DialogType.ADD_LIST,\n      };\n    },\n    openEditListDialog: (state, action: PayloadAction<number>) => {\n      state.dialogState = {\n        type: DialogType.EDIT_LIST,\n        index: action.payload,\n      };\n    },\n    openAddItemDialog: state => {\n      state.dialogState = {\n        type: DialogType.ADD_ITEM,\n      };\n    },\n    openEditItemDialog: (state, action: PayloadAction<number>) => {\n      state.dialogState = {\n        type: DialogType.EDIT_ITEM,\n        index: action.payload,\n      };\n    },\n    openSetupGoogleSheetsDialog: state => {\n      state.dialogState = {\n        type: DialogType.SETUP_GOOGLE_SHEETS,\n      };\n    },\n    closeDialog: state => {\n      state.dialogState = undefined;\n    },\n    copyToClipboard: state => {\n      if (navigator?.clipboard?.writeText) {\n        navigator.clipboard.writeText(JSON.stringify(state));\n        logger.info('Copied to clipboard');\n      } else {\n        logger.error('ERROR: denied use of browser clipboard');\n      }\n    },\n    copyItemsToClipboard: state => {\n      const listIndex = state.selectedList;\n      if (listIndex !== undefined && isInBounds(listIndex, state.lists)) {\n        if (navigator?.clipboard?.writeText) {\n          const items = state.lists[listIndex].items;\n          const text = exportText(items);\n          navigator.clipboard.writeText(text);\n          logger.info(`Copied ${items.length} items to clipboard`);\n        } else {\n          logger.error('ERROR: denied use of browser clipboard');\n        }\n      }\n    },\n    updateState: (state, action: PayloadAction<ShopperState>) => {\n      state.selectedList = undefined;\n      state.categoryColorMapper = undefined;\n      Object.assign(state, action.payload);\n    },\n    // set sign in\n    setGoogleSheetsLoggedIn: (state, action: PayloadAction<boolean>) => {\n      state.googleSheetsLoggedIn = action.payload;\n    },\n    setGoogleSheetsDetails: (\n      state,\n      action: PayloadAction<ShopperState['googleSheets']>\n    ) => {\n      state.googleSheets = action.payload;\n    },\n  },\n});\n\nexport const copyToGoogleSheet = (): AppThunk => async (_, getState) => {\n  try {\n    const state = getState();\n    if (state.googleSheets === undefined) {\n      logger.error('Missing google sheets info');\n      return;\n    }\n    const values = serialize(state, true);\n    const spreadsheetId = state.googleSheets.spreadsheetId;\n    const sheet = state.googleSheets.range;\n    // clear is necessary to ensure any old value is removed\n    await batchClear(spreadsheetId, sheet);\n    await batchUpdate(spreadsheetId, sheet, values);\n    logger.info('Copied to google sheet');\n  } catch (error) {\n    console.log(error);\n    logger.error(`ERROR: ${error}`);\n  }\n};\n\nexport const importFromGoogleSheets =\n  (): AppThunk => async (dispatch, getState) => {\n    try {\n      const state = getState();\n      if (state.googleSheets === undefined) {\n        logger.error('Missing google sheets info');\n        return;\n      }\n      const spreadsheetId = state.googleSheets.spreadsheetId;\n      const sheet = state.googleSheets.range;\n      const values = await getValues(spreadsheetId, sheet);\n      dispatch(actions.updateState(values));\n      logger.info('Imported from google sheet');\n    } catch (error) {\n      console.log(error);\n      logger.error(`ERROR: ${error}`);\n    }\n  };\n\nexport const addItemsFromClipboard =\n  (): AppThunk => async (dispatch, getState) => {\n    if (navigator?.clipboard?.readText) {\n      navigator.clipboard\n        .readText()\n        .then(value => {\n          const items = importText(value);\n          const state = getState();\n\n          const listIndex = state.selectedList;\n          if (\n            items.length > 0 &&\n            listIndex !== undefined &&\n            isInBounds(listIndex, state.lists)\n          ) {\n            const clonedState = JSON.parse(JSON.stringify(state));\n            const fullItems = items.map(({ name, comment, enabled }) => ({\n              id: newItemId(),\n              name,\n              comment,\n              enabled,\n            }));\n            clonedState.lists[listIndex].items.push(...fullItems);\n            dispatch(actions.updateState(clonedState));\n            logger.info(`Added ${items.length ?? 0} items from clipboard`);\n          } else {\n            logger.error('Failed to add items from clipboard');\n          }\n        })\n        .catch(error => {\n          console.log(error);\n          logger.error(`ERROR: ${error}`);\n        });\n    } else {\n      logger.error('ERROR: denied use of browser clipboard');\n    }\n  };\n\nexport const importFromClipboard = (): AppThunk => dispatch => {\n  if (navigator?.clipboard?.readText) {\n    navigator.clipboard\n      .readText()\n      .then(value => {\n        const obj = JSON.parse(value);\n        const state = validate(obj);\n        dispatch(actions.updateState(state));\n        logger.info('Imported from clipboard');\n      })\n      .catch(error => {\n        console.log(error);\n        logger.error(`ERROR: ${error}`);\n      });\n  } else {\n    logger.error('ERROR: denied use of browser clipboard');\n  }\n};\n\nexport const { actions, reducer } = shopperSlice;\n","function dequeueIfNeeded(isShopperQueued: boolean, isListSelected: boolean) {\n  if (isShopperQueued && !isListSelected) {\n    window.history.back();\n  }\n}\n\nfunction enqueueIfNeeded(isShopperQueued: boolean, isListSelected: boolean) {\n  if (!isShopperQueued && isListSelected) {\n    window.history.pushState({ isShopperQueued: true }, 'shopper');\n  }\n}\n\nfunction isShopperQueued() {\n  return window.history.state?.isShopperQueued === true;\n}\n\nexport { dequeueIfNeeded, enqueueIfNeeded, isShopperQueued };\n","import { configureStore } from '@reduxjs/toolkit';\nimport {\n  reducer,\n  actions as sliceActions,\n  importFromClipboard,\n  importFromGoogleSheets,\n  copyToGoogleSheet,\n  addItemsFromClipboard,\n} from './slice';\nimport { save } from './localStorage';\nimport { enqueueIfNeeded, dequeueIfNeeded, isShopperQueued } from '../history';\n\nexport const store = configureStore({ reducer });\n\nexport type RootState = ReturnType<typeof store.getState>;\n\nexport const actions = {\n  ...sliceActions,\n  importFromClipboard,\n  importFromGoogleSheets,\n  copyToGoogleSheet,\n  addItemsFromClipboard,\n};\n\n// auto-save\nstore.subscribe(() => {\n  const state = store.getState();\n  save(state);\n  // console.log(JSON.stringify(state));\n\n  const isQueued = isShopperQueued();\n  const isListSelected = state.selectedList !== undefined;\n\n  enqueueIfNeeded(isQueued, isListSelected);\n  dequeueIfNeeded(isQueued, isListSelected);\n});\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport AddIcon from '@material-ui/icons/AddShoppingCart';\nimport IconButton from '@material-ui/core/IconButton';\n\ninterface Props {\n  openDialog: () => void;\n}\n\nexport default function (props: Props) {\n  const classes = useStyles();\n\n  return (\n    <IconButton\n      className={classes.button}\n      edge=\"end\"\n      title=\"Add list\"\n      color=\"secondary\"\n      aria-label=\"add\"\n      onClick={() => props.openDialog()}\n    >\n      <AddIcon />\n    </IconButton>\n  );\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      color: 'inherit',\n    },\n  })\n);\n","import { connect } from 'react-redux';\nimport { actions } from '../../redux/store';\nimport Component from './AddButton';\n\nconst connector = connect(() => ({}), {\n  openDialog: () => actions.openAddListDialog(),\n});\n\nexport default connector(Component);\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport AddIcon from '@material-ui/icons/Add';\nimport IconButton from '@material-ui/core/IconButton';\n\ninterface Props {\n  openDialog: () => void;\n}\n\nexport default function (props: Props) {\n  const classes = useStyles();\n\n  return (\n    <IconButton\n      className={classes.button}\n      edge=\"end\"\n      title=\"Add item\"\n      color=\"secondary\"\n      aria-label=\"add\"\n      onClick={() => props.openDialog()}\n    >\n      <AddIcon />\n    </IconButton>\n  );\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      color: 'inherit',\n    },\n  })\n);\n","import { connect } from 'react-redux';\nimport { actions } from '../../redux/store';\nimport Component from './AddButton';\n\nconst connector = connect(() => ({}), {\n  openDialog: () => actions.openAddItemDialog(),\n});\n\nexport default connector(Component);\n","import React, { ReactNode } from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport IconButton from '@material-ui/core/IconButton';\nimport Divider from '@material-ui/core/Divider';\n\ninterface Props {\n  children: ReactNode;\n  actions: {\n    label: string;\n    action: () => void;\n    selected?: boolean;\n  }[][];\n}\n\nexport default function (props: Props) {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return (\n    <div>\n      <IconButton\n        className={classes.button}\n        aria-controls=\"simple-menu\"\n        edge=\"end\"\n        aria-label=\"menu\"\n        color=\"secondary\"\n        aria-haspopup=\"true\"\n        onClick={handleClick}\n      >\n        {props.children}\n      </IconButton>\n      <Menu\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}\n      >\n        {props.actions.flatMap((actionList, outerIndex) => {\n          const result = actionList.map(\n            ({ label, action, selected }, innerIndex) => (\n              <MenuItem\n                key={`outer=${outerIndex}-inner${innerIndex}`}\n                onClick={() => {\n                  handleClose();\n                  action();\n                }}\n                selected={!!selected}\n              >\n                {label}\n              </MenuItem>\n            )\n          );\n          // add separator if adding a new set of actions\n          if (outerIndex !== 0) {\n            result.unshift(<Divider key={`divider-${outerIndex}`} />);\n          }\n          return result;\n        })}\n      </Menu>\n    </div>\n  );\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      color: 'inherit',\n    },\n  })\n);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport type { RootState } from '../../redux/store';\nimport { actions } from '../../redux/store';\nimport { init } from './spreadsheet';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\n// status icons\nimport NotAvailable from '@material-ui/icons/CloudOff';\nimport Available from '@material-ui/icons/CloudDone';\nimport Pending from '@material-ui/core/CircularProgress';\n\ntype SheetControlProps = {\n  clientId?: string;\n  apiKey?: string;\n  // login status\n  status?: boolean;\n  setLoginStatus: (status: boolean) => void;\n  openDialog: () => void;\n  isOnline: boolean;\n};\n\nfunction SheetControl(props: SheetControlProps) {\n  const classes = useStyles();\n\n  React.useEffect(\n    () =>\n      init(props.apiKey, props.clientId, props.isOnline, props.setLoginStatus),\n    [props.apiKey, props.clientId, props.setLoginStatus, props.isOnline]\n  );\n\n  const icon =\n    props.apiKey === undefined ||\n    props.clientId === undefined ||\n    props.status === false ||\n    props.isOnline === false ? (\n      <NotAvailable />\n    ) : props.status === true ? (\n      <Available />\n    ) : (\n      <Pending color=\"inherit\" size={30} />\n    );\n\n  return (\n    <IconButton\n      className={classes.button}\n      edge=\"end\"\n      title=\"Google Sheets API Access Status\"\n      color=\"secondary\"\n      aria-label=\"google-sheets\"\n      onClick={() => props.openDialog()}\n    >\n      {icon}\n    </IconButton>\n  );\n}\n\nexport const mapStateToProps = (state: RootState) => {\n  return {\n    clientId: state.googleSheets?.clientId,\n    apiKey: state.googleSheets?.apiKey,\n    status: state.googleSheetsLoggedIn,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  setLoginStatus: (status: boolean) => actions.setGoogleSheetsLoggedIn(status),\n  openDialog: () => actions.openSetupGoogleSheetsDialog(),\n})(SheetControl);\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      color: 'inherit',\n    },\n  })\n);\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport MenuIcon from '@material-ui/icons/ArrowBackRounded';\nimport IconButton from '@material-ui/core/IconButton';\nimport AddList from '../shopping-list/AddButtonContainer';\nimport AddItem from '../item-list/AddButtonContainer';\nimport Menu from '../common/Menu';\nimport ActionsMenuIcon from '@material-ui/icons/MoreVert';\nimport SortMenuIcon from '@material-ui/icons/Sort';\nimport {\n  enqueueIfNeeded,\n  dequeueIfNeeded,\n  isShopperQueued,\n} from '../../history';\n\nimport version from '../../../version';\nimport { toast } from 'react-toastify';\nimport { SortMode, CategoryMode } from '../../redux/state';\nimport SheetControl from '../google-sheets/SheetControl';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 0,\n    },\n    title: {\n      flexGrow: 0,\n    },\n    menuButton: {\n      flexGrow: 0,\n    },\n    rightButton: {\n      // flexDirection: 'row',\n      flexGrow: 1,\n      display: 'flex',\n      justifyContent: 'flex-end',\n      alignItems: 'flex-end',\n      // border: '1px solid blue',\n    },\n  })\n);\n\ninterface Props {\n  selectedList?: {\n    listName: string;\n    pendingItemCount: number;\n    totalItemCount: number;\n  };\n  googleSheetsEnabled: boolean;\n  sortMode: SortMode;\n  categoryMode: CategoryMode;\n  itemClick: boolean;\n  googleSheetActions: boolean;\n  deselectList: () => void;\n  copyItemsToClipboard: () => void;\n  toggleItemClick: () => void;\n  toggleGoogleSheetActions: () => void;\n  copyToClipboard: () => void;\n  copyToGoogleSheet: () => void;\n  importFromGoogleSheets: () => void;\n  importFromClipboard: () => void;\n  undoItemDeletion: () => void;\n  undoListDeletion: () => void;\n  addItemsFromClipboard: () => void;\n  // sort\n  setDefaultSort: () => void;\n  setCategorySort: () => void;\n  setAlphabeticSort: () => void;\n  // categories\n  setTextCategoryMode: () => void;\n  setHiddenCategoryMode: () => void;\n  setColorCategoryMode: () => void;\n}\n\nconst shopperTitle = 'Shopper';\n\nexport default function ButtonAppBar(props: Props) {\n  const classes = useStyles();\n\n  let title = shopperTitle;\n  if (props.selectedList) {\n    const { listName, pendingItemCount, totalItemCount } = props.selectedList;\n    title = listName!;\n    if (totalItemCount! > 0) {\n      title = `(${pendingItemCount}) ${title}`;\n    }\n  }\n\n  const itemActions = [\n    {\n      label: 'copy list items to clipboard',\n      action: () => props.copyItemsToClipboard(),\n    },\n    {\n      label: 'add items from clipboard',\n      action: () => props.addItemsFromClipboard(),\n    },\n  ];\n\n  const itemClickToggle = [\n    {\n      label: `${props.itemClick ? 'disable' : 'enable'} item click`,\n      action: () => props.toggleItemClick(),\n    },\n  ];\n\n  const googleSheetToggle = [\n    {\n      label: `${\n        props.googleSheetActions ? 'disable' : 'enable'\n      } google sheet actions`,\n      action: () => props.toggleGoogleSheetActions(),\n    },\n  ];\n\n  const defaultActions = [\n    {\n      label: 'load app state from clipboard',\n      action: () => props.importFromClipboard(),\n    },\n    {\n      label: 'copy app state to clipboard',\n      action: () => props.copyToClipboard(),\n    },\n  ];\n\n  const googleSheetsActions = [\n    {\n      label: 'import from google sheet',\n      action: () => props.importFromGoogleSheets(),\n    },\n    {\n      label: 'export to google sheet',\n      action: () => props.copyToGoogleSheet(),\n    },\n  ];\n\n  const contextActions = [\n    {\n      label: `undo ${props.selectedList ? 'item' : 'list'} deletion`,\n      action: () =>\n        props.selectedList\n          ? props.undoItemDeletion()\n          : props.undoListDeletion(),\n    },\n  ];\n\n  const actions = [googleSheetToggle, defaultActions, contextActions];\n  if (props.googleSheetsEnabled && props.googleSheetActions) {\n    actions.unshift(googleSheetsActions);\n  }\n  if (props.selectedList) {\n    actions.unshift(itemClickToggle);\n    actions.unshift(itemActions);\n  }\n\n  const sortActions = [\n    [\n      {\n        label: 'default sort',\n        action: () => props.setDefaultSort(),\n        selected: props.sortMode === 'default',\n      },\n      {\n        label: 'category sort',\n        action: () => props.setCategorySort(),\n        selected: props.sortMode === 'categories',\n      },\n      {\n        label: 'alphabetic sort',\n        action: () => props.setAlphabeticSort(),\n        selected: props.sortMode === 'alphabetic',\n      },\n    ],\n    [\n      {\n        label: 'hidden category',\n        action: () => props.setHiddenCategoryMode(),\n        selected: props.categoryMode === 'hidden',\n      },\n      {\n        label: 'text category',\n        action: () => props.setTextCategoryMode(),\n        selected: props.categoryMode === 'text',\n      },\n      {\n        label: 'color category',\n        action: () => props.setColorCategoryMode(),\n        selected: props.categoryMode === 'color',\n      },\n    ],\n  ];\n\n  const [isOnline, setIsOnline] = React.useState(navigator.onLine);\n  window.addEventListener('online', () => setIsOnline(true));\n  window.addEventListener('offline', () => setIsOnline(false));\n\n  React.useEffect(() => {\n    const isQueued = isShopperQueued();\n    const isListSelected = props.selectedList !== undefined;\n\n    enqueueIfNeeded(isQueued, isListSelected);\n    dequeueIfNeeded(isQueued, isListSelected);\n\n    window.addEventListener('popstate', () => {\n      props.deselectList();\n    });\n\n    // Never unmounted since AppBar is always visible.\n    // We do not care about changes on dependencies.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"static\">\n        <Toolbar>\n          {props.selectedList && (\n            <IconButton\n              edge=\"start\"\n              className={classes.menuButton}\n              color=\"inherit\"\n              aria-label=\"menu\"\n              onClick={() => props.deselectList()}\n            >\n              <MenuIcon />\n            </IconButton>\n          )}\n          <Typography\n            variant=\"h6\"\n            className={classes.title}\n            onClick={() => {\n              if (title === shopperTitle) {\n                toast.info(version);\n              }\n            }}\n          >\n            {title}\n          </Typography>\n          {props.googleSheetActions && <SheetControl isOnline={isOnline} />}\n\n          <div className={classes.rightButton}>\n            {props.selectedList ? <AddItem /> : <AddList />}\n          </div>\n          {props.selectedList && (\n            <Menu actions={sortActions}>\n              <SortMenuIcon />\n            </Menu>\n          )}\n          <Menu actions={actions}>\n            <ActionsMenuIcon />\n          </Menu>\n        </Toolbar>\n      </AppBar>\n    </div>\n  );\n}\n","import { connect } from 'react-redux';\nimport type { RootState } from '../../redux/store';\nimport { actions } from '../../redux/store';\nimport Component from './AppBar';\n\nexport const mapStateToProps = (state: RootState) => {\n  if (state.selectedList !== undefined) {\n    const list = state.lists[state.selectedList!];\n    const listName = list.name;\n    const totalItemCount = list.items.length;\n    const pendingItemCount = list.items.reduce(\n      (prev, curr) => prev + Number(!!curr.enabled),\n      0\n    );\n    return {\n      selectedList: {\n        totalItemCount,\n        pendingItemCount,\n        listName,\n      },\n      googleSheetsEnabled: state.googleSheetsLoggedIn === true,\n      sortMode: state.sortMode,\n      categoryMode: state.categoryMode,\n      itemClick: state.itemClick,\n      googleSheetActions: state.googleSheetActions,\n    };\n  }\n\n  return {\n    googleSheetsEnabled: state.googleSheetsLoggedIn === true,\n    selectedList: undefined,\n    sortMode: 'default' as const,\n    categoryMode: 'text' as const,\n    itemClick: state.itemClick,\n    googleSheetActions: state.googleSheetActions,\n  };\n};\n\nconst connector = connect(mapStateToProps, {\n  deselectList: () => actions.deselectList(),\n  copyItemsToClipboard: () => actions.copyItemsToClipboard(),\n  copyToClipboard: () => actions.copyToClipboard(),\n  importFromClipboard: () => actions.importFromClipboard(),\n  copyToGoogleSheet: () => actions.copyToGoogleSheet(),\n  importFromGoogleSheets: () => actions.importFromGoogleSheets(),\n  undoItemDeletion: () => actions.undoItemDeletion(),\n  undoListDeletion: () => actions.undoListDeletion(),\n  addItemsFromClipboard: () => actions.addItemsFromClipboard(),\n  // sort\n  setDefaultSort: () => actions.setDefaultSort(),\n  setCategorySort: () => actions.setCategorySort(),\n  setAlphabeticSort: () => actions.setAlphabeticSort(),\n  // item click\n  toggleItemClick: () => actions.toggleItemClick(),\n  toggleGoogleSheetActions: () => actions.toggleGoogleSheetActions(),\n  // category\n  setTextCategoryMode: () => actions.setTextCategoryMode(),\n  setHiddenCategoryMode: () => actions.setHiddenCategoryMode(),\n  setColorCategoryMode: () => actions.setColorCategoryMode(),\n});\n\nexport default connector(Component);\n","export default 'commit: 4726898 (2022-12-19T19:06:13.023Z)';\n","import React from 'react';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Divider from '@material-ui/core/Divider';\n\ninterface Props {\n  position?: {\n    x: number;\n    y: number;\n    index: number;\n  };\n\n  actions: {\n    label: string;\n    action: (index: number) => void;\n  }[][];\n\n  onClose: () => void;\n}\n\nexport default function (props: Props) {\n  const open = props.position !== undefined;\n  const anchorPosition =\n    props.position !== undefined\n      ? { top: props.position.y, left: props.position.x }\n      : undefined;\n\n  return (\n    <Menu\n      keepMounted\n      open={open}\n      onClose={() => props.onClose()}\n      anchorReference=\"anchorPosition\"\n      anchorPosition={anchorPosition}\n    >\n      {props.actions.flatMap((actionList, outerIndex) => {\n        const result = actionList.map(({ label, action }, innerIndex) => (\n          <MenuItem\n            key={`outer=${outerIndex}-inner${innerIndex}`}\n            onClick={() => {\n              if (props.position) {\n                // store in case of changes\n                const { index } = props.position;\n                props.onClose();\n                if (index !== null) {\n                  action(index);\n                }\n              }\n            }}\n          >\n            {label}\n          </MenuItem>\n        ));\n        // add separator if adding a new set of actions\n        if (outerIndex !== 0) {\n          result.unshift(<Divider key={`divider-${outerIndex}`} />);\n        }\n        return result;\n      })}\n    </Menu>\n  );\n}\n","import React, { forwardRef, ReactNode } from 'react';\nimport { createStyles, Theme, makeStyles } from '@material-ui/core/styles';\nimport FlipMove from 'react-flip-move';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ContextMenu from './ContextMenu';\n\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport KeyboardArrowLeftIcon from '@material-ui/icons/KeyboardArrowLeft';\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\nimport DoneIcon from '@material-ui/icons/Done';\n\n// TODO: update SwipeableViews to remove \"Legacy context API has been detected within a strict-mode tree\" warning. See: https://github.com/oliviertassinari/react-swipeable-views/issues/596\nimport SwipeableViews from 'react-swipeable-views';\nimport { CategoryMode } from '../../redux/state';\n\nexport interface Props {\n  lists: {\n    id: string;\n    name: string;\n    comment: string;\n    enabled?: boolean;\n    category?: string;\n    index: number;\n  }[];\n  onClick: (index: number) => void;\n  onDelete: (index: number) => void;\n  swipeRight: boolean;\n  clickEnabled: boolean;\n  actions: {\n    label: string;\n    action: (index: number) => void;\n  }[][];\n  categoryMode?: CategoryMode;\n  extractColor?: (category: string | undefined) => string | undefined;\n}\n\nexport default function (props: Props) {\n  const classes = useStyles();\n\n  const mouse = React.useRef({ x: 0, time: 0 });\n\n  const handleMouseDown = (e: any) => {\n    mouse.current.x = e.screenX;\n    mouse.current.time = Date.now();\n  };\n\n  const handleMouseClick = (index: number) => (e: React.MouseEvent) => {\n    // some horizontal movement, ignore click\n    const delta = Math.abs(e.screenX - mouse.current.x);\n    if (delta > 10) {\n      e.preventDefault();\n      return;\n    }\n\n    if (props.clickEnabled && e.type === 'click') {\n      props.onClick(index);\n      return;\n    }\n  };\n\n  // on swipe index change\n  const onChangeIndex = (index: number, start: number) => (i: number) => {\n    if (i < start) {\n      props.onClick(index);\n      return;\n    }\n    if (i > start) {\n      props.onDelete(index);\n      return;\n    }\n  };\n\n  const [state, setState] = React.useState<\n    | {\n        x: number;\n        y: number;\n        index: number;\n      }\n    | undefined\n  >(undefined);\n\n  const handleOpenContextMenu =\n    (index: number) => (event: React.MouseEvent<HTMLDivElement>) => {\n      event.preventDefault();\n      setState({\n        x: event.clientX - 4,\n        y: event.clientY - 4,\n        index,\n      });\n    };\n\n  const handleCloseContextMenu = () => {\n    setState(undefined);\n  };\n\n  const Wrapper = forwardRef<HTMLDivElement, { children: ReactNode }>(\n    (props, ref) => <div ref={ref}>{props.children}</div>\n  );\n\n  return (\n    <div className={classes.root}>\n      <ContextMenu\n        position={state}\n        onClose={handleCloseContextMenu}\n        actions={props.actions}\n      />\n      <List component=\"nav\" className={classes.list}>\n        <FlipMove enterAnimation=\"fade\" leaveAnimation=\"fade\">\n          {props.lists.map(\n            ({ id, name, comment, enabled, index, category }, arrayIndex) => {\n              const panels = [\n                <ListItem\n                  key=\"middle-panel\"\n                  className={\n                    enabled !== false\n                      ? classes.enabledItem\n                      : classes.disabledItem\n                  }\n                  style={{\n                    backgroundColor:\n                      props.categoryMode === 'color' && props.extractColor\n                        ? props.extractColor(category)\n                        : undefined,\n                  }}\n                  button\n                  onContextMenu={handleOpenContextMenu(index)}\n                  onClick={handleMouseClick(index)}\n                  onMouseDown={handleMouseDown}\n                >\n                  <ListItemText primary={name} secondary={comment} />\n                  {category && props.categoryMode === 'text' && (\n                    <div>{category}</div>\n                  )}\n                </ListItem>,\n                rightPanel,\n              ];\n              if (props.swipeRight) {\n                panels.unshift(leftPanel);\n              }\n              const startIndex = props.swipeRight ? 1 : 0;\n              // hack: changes the key value to force new item on enabled/disabled\n              // since otherwise SwipeableViews will remain on swiped panel and\n              // FlipMove will not use the enter/leave animations.\n              const key = `${id}-${enabled}`;\n              const style =\n                props.lists.length - 1 === arrayIndex\n                  ? { paddingBottom: '50px' }\n                  : {};\n              return (\n                <Wrapper key={key}>\n                  <SwipeableViews\n                    style={style}\n                    key={key}\n                    index={startIndex}\n                    enableMouseEvents\n                    onChangeIndex={onChangeIndex(index, startIndex)}\n                  >\n                    {panels}\n                  </SwipeableViews>\n                </Wrapper>\n              );\n            }\n          )}\n        </FlipMove>\n      </List>\n    </div>\n  );\n}\n\nconst leftPanel = (\n  <div\n    key=\"left-panel\"\n    style={{\n      backgroundColor: '#a9f58c',\n      height: '100%',\n      direction: 'rtl',\n    }}\n  >\n    <KeyboardArrowRightIcon\n      style={{ height: '100%', marginRight: '10px', color: 'gray' }}\n    />\n    <DoneIcon style={{ height: '100%', marginRight: '10px' }} />\n  </div>\n);\n\nconst rightPanel = (\n  <div key=\"right-panel\" style={{ backgroundColor: '#ed837b', height: '100%' }}>\n    <KeyboardArrowLeftIcon\n      style={{ height: '100%', marginLeft: '10px', color: 'gray' }}\n    />\n    <DeleteIcon style={{ height: '100%', marginLeft: '10px' }} />\n  </div>\n);\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      backgroundColor: theme.palette.background.default,\n      flex: '1',\n      height: '90vh',\n      // border: '1px solid red',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    list: {\n      overflowY: 'scroll',\n      overflowX: 'hidden',\n      // border: '1px solid blue',\n      minHeight: '100%',\n      backgroundColor: theme.palette.background.default,\n    },\n    enabledItem: {\n      backgroundColor: 'white',\n      // marginTop: '2px',\n      // marginBottom: '2px',\n      userSelect: 'none',\n      textDecoration: 'none',\n      opacity: '1',\n    },\n    disabledItem: {\n      backgroundColor: 'white',\n      // marginTop: '2px',\n      // marginBottom: '2px',\n      userSelect: 'none',\n      textDecoration: 'line-through',\n      opacity: '0.5',\n      '&:hover': {\n        textDecoration: 'line-through',\n      },\n    },\n    menuButton: {\n      color: theme.palette.grey[500],\n    },\n  })\n);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport List, { Props as ListProps } from '../common/List';\n\nconst mapToListState = (state: RootState) => {\n  return {\n    lists: state.lists.map(({ id, name, items }, index) => ({\n      id,\n      name,\n      comment: `${items.length} items`,\n      index,\n    })),\n  };\n};\n\nconst dispatchToProps = {\n  onDelete: (index: number) => actions.deleteList(index),\n  onEdit: (index: number) => actions.openEditListDialog(index),\n  onClick: (index: number) => actions.selectList(index),\n};\n\ntype Props = Omit<ListProps, 'actions' | 'swipeRight' | 'clickEnabled'> & {\n  onEdit: (index: number) => void;\n};\n\nfunction ListWithContextMenu(props: Props) {\n  return (\n    <List\n      {...props}\n      swipeRight={false}\n      clickEnabled={true}\n      actions={[\n        [\n          {\n            label: 'Edit',\n            action: index => props.onEdit(index),\n          },\n        ],\n        [\n          {\n            label: 'Delete',\n            action: index => props.onDelete(index),\n          },\n        ],\n      ]}\n    />\n  );\n}\n\nconst connector = connect(mapToListState, dispatchToProps);\nexport default connector(ListWithContextMenu);\n","import React, { ReactNode } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { useDispatch } from 'react-redux';\nimport { actions } from '../../redux/slice';\n\ninterface Props {\n  isOpen: boolean;\n  children: ReactNode | ReactNode[];\n\n  title: string;\n  ok: string;\n  cancel?: string;\n  another?: string;\n\n  description: string;\n  isValid: boolean;\n\n  onClose: (commit: boolean) => void;\n  onOpen: () => void;\n}\n\nexport default function (props: Props) {\n  const dispatch = useDispatch();\n\n  function handleClose(commit: boolean, closeDialog: boolean = true) {\n    props.onClose(commit);\n    if (closeDialog) {\n      dispatch(actions.closeDialog());\n    } else {\n      props.onOpen();\n    }\n  }\n\n  function handleOpen() {\n    props.onOpen();\n  }\n\n  return (\n    <div>\n      <Dialog\n        // full screen dialog works best on mobile\n        fullScreen\n        open={props.isOpen}\n        onEnter={() => handleOpen()}\n        onClose={() => handleClose(false)}\n      >\n        <DialogActions style={{ background: '#eeeeee' }}>\n          {props.another !== undefined && (\n            <Button\n              onClick={() => handleClose(true, false)}\n              color=\"primary\"\n              disabled={!props.isValid}\n            >\n              {props.another}\n            </Button>\n          )}\n          {props.another !== undefined && <div style={{ flex: '1 0 0' }} />}\n          {props.cancel !== undefined && (\n            <Button onClick={() => handleClose(false)} color=\"primary\">\n              {props.cancel}\n            </Button>\n          )}\n          <Button\n            onClick={() => handleClose(true)}\n            color=\"primary\"\n            disabled={!props.isValid}\n          >\n            {props.ok}\n          </Button>\n        </DialogActions>\n        <DialogTitle>{props.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText>{props.description}</DialogContentText>\n          {props.children}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Dialog from '../common/Dialog';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport { importText } from '../../importer';\n\ninterface Props {\n  value: string;\n  title: string;\n  okText: string;\n  cancelText: string;\n  anotherText?: string;\n  descriptionText: string;\n  // internal\n  isOpen: boolean;\n  isEdit: boolean;\n  onCommit: (value: {\n    name: string;\n    items: { name: string; comment: string, enabled: boolean }[];\n  }) => void;\n}\n\nconst isValid = (newValue: string) => newValue.trim().length > 0;\n\nexport default function (props: Props) {\n  const initialCheck = isValid(props.value);\n  const [isValidCheck, setValidCheck] = React.useState(initialCheck);\n  const [tmpValue, setTmpValue] = React.useState(props.value);\n  const [includeClipboard, setIncludeClipboard] = React.useState<{\n    includeClipboard: boolean;\n    items: { name: string; comment: string, enabled: boolean }[];\n  }>({\n    includeClipboard: false,\n    items: [],\n  });\n\n  function handleClose(commit: boolean) {\n    if (commit) {\n      props.onCommit({\n        name: tmpValue,\n        items: includeClipboard.includeClipboard ? includeClipboard.items : [],\n      });\n    }\n  }\n\n  function handleOpen() {\n    setTmpValue(props.value);\n    setValidCheck(isValid(props.value));\n    setIncludeClipboard({ includeClipboard: false, items: [] });\n    if (defaultFocus.current) {\n      defaultFocus.current.focus();\n    }\n  }\n\n  function handleChange(event: any) {\n    const newValue = event.target.value;\n    setTmpValue(newValue);\n    setValidCheck(isValid(newValue));\n  }\n\n  async function importFromClipboard() {\n    try {\n      const txt = await navigator.clipboard.readText();\n      return importText(txt);\n    } catch (error) {\n      console.log(`Error importing from clipboard: ${error}`);\n      return [];\n    }\n  }\n\n  async function handleIncludeClipboard(event: any) {\n    const includeClipboard = event.target.checked;\n    const items = includeClipboard ? await importFromClipboard() : [];\n\n    setIncludeClipboard({\n      includeClipboard,\n      items,\n    });\n  }\n\n  const count = includeClipboard.includeClipboard\n    ? `${includeClipboard.items.length} `\n    : ' ';\n  const label = `Include ${count}items from clipboard`;\n  const allowedImport = navigator?.clipboard?.readText !== undefined;\n\n  const defaultFocus = React.useRef<any>(null);\n\n  return (\n    <Dialog\n      isOpen={props.isOpen}\n      isValid={isValidCheck}\n      onOpen={handleOpen}\n      onClose={handleClose}\n      title={props.title}\n      description={props.descriptionText}\n      ok={props.okText}\n      another={props.anotherText}\n      cancel={props.cancelText}\n    >\n      <TextField\n        error={!isValidCheck}\n        inputRef={input => {\n          defaultFocus.current = input;\n        }}\n        margin=\"dense\"\n        label=\"List name\"\n        type=\"text\"\n        onChange={handleChange}\n        fullWidth\n        value={tmpValue}\n        InputLabelProps={{\n          shrink: true,\n        }}\n      />\n      {!props.isEdit && allowedImport && (\n        <FormControlLabel\n          control={\n            <Checkbox\n              checked={includeClipboard.includeClipboard}\n              onChange={handleIncludeClipboard}\n              color=\"primary\"\n            />\n          }\n          label={label}\n        />\n      )}\n    </Dialog>\n  );\n}\n","import { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport Component from './AddDialog';\nimport { DialogType } from '../../redux/state';\n\nconst mapStateToProps = (state: RootState) => ({\n  isOpen: state.dialogState?.type === DialogType.ADD_LIST,\n});\n\nconst connector = connect(mapStateToProps, {\n  onCommit: (value: {\n    name: string;\n    items: { name: string; comment: string, enabled: boolean }[];\n  }) => value && actions.addList(value),\n});\n\nexport default connector(Component);\n","import React from 'react';\nimport ListDialog from './GenericDialog';\n\ninterface Props {\n  isOpen: boolean;\n  onCommit: (value: {\n    name: string;\n    items: { name: string; comment: string, enabled: boolean }[];\n  }) => void;\n}\n\nconst initialValue = '';\n\nexport default function (props: Props) {\n  return (\n    <ListDialog\n      value={initialValue}\n      title=\"Create List\"\n      okText=\"Add\"\n      cancelText=\"Cancel\"\n      anotherText=\"Add Another\"\n      isEdit={false}\n      descriptionText=\"Pick the name for your new list.\"\n      {...props}\n    />\n  );\n}\n","import React from 'react';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport NativeSelect from '@material-ui/core/NativeSelect';\n\ninterface SelectProps {\n  title: string;\n  choices: string[];\n  value: string | undefined;\n  onChange: (value: number) => void;\n}\n\nexport default function Select(props: SelectProps) {\n  return (\n    <div style={{ marginTop: 10 }}>\n      <InputLabel shrink htmlFor=\"age-native-label-placeholder\">\n        {props.title}\n      </InputLabel>\n      <NativeSelect\n        fullWidth\n        value={props.value}\n        onChange={event => props.onChange(event.target.selectedIndex)}\n      >\n        {props.choices.map((choice, index) => {\n          return (\n            <option value={choice} key={index}>\n              {choice}\n            </option>\n          );\n        })}\n      </NativeSelect>\n    </div>\n  );\n}\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '../common/Dialog';\nimport Select from '../common/Select';\nimport { SimpleItem as Item } from '../../redux/state';\n\ninterface Props {\n  title: string;\n  okText: string;\n  cancelText: string;\n  anotherText?: string;\n  descriptionText: string;\n  listOptions?: string[];\n  categories: string[];\n  selectedList?: number;\n  // ...\n  isOpen: boolean;\n  value: { name: string; comment: string; category?: string };\n  onCommit: (value: {\n    name: string;\n    comment: string;\n    listIndex?: number;\n    category?: string;\n  }) => void;\n}\n\nconst isValid = ({ name, category }: Item) => ({\n  name: name.trim().length > 0,\n  // these are always valid\n  comment: true,\n  category: true,\n});\n\nexport default function (props: Props) {\n  const initialCheck = isValid(props.value);\n  const [isValidCheck, setValidCheck] = React.useState(initialCheck);\n  const [tmpValue, setTmpValue] = React.useState({\n    ...props.value,\n    category: props.value.category || '',\n  });\n  const [tmpList, setTmpList] = React.useState(props.selectedList);\n  const [showText, setShowText] = React.useState(false);\n\n  function handleClose(commit: boolean) {\n    if (commit) {\n      const { category } = tmpValue;\n      props.onCommit({\n        ...tmpValue,\n        category: category.trim().length <= 0 ? undefined : category,\n        listIndex: tmpList,\n      });\n    }\n  }\n\n  function handleOpen() {\n    setTmpValue({ ...props.value, category: props.value.category || '' });\n    setValidCheck(isValid(props.value));\n    setTmpList(props.selectedList);\n    setShowText(false);\n    if (defaultFocus.current) {\n      defaultFocus.current.focus();\n    }\n  }\n\n  function handleNameChange(event: any) {\n    const newValue = {\n      ...tmpValue,\n      name: event.target.value,\n    };\n    setTmpValue(newValue);\n    setValidCheck(isValid(newValue));\n  }\n\n  function handleCommentChange(event: any) {\n    const newValue = {\n      ...tmpValue,\n      comment: event.target.value,\n    };\n    setTmpValue(newValue);\n    setValidCheck(isValid(newValue));\n  }\n\n  function handleListChange(index: number) {\n    setTmpList(index);\n  }\n\n  function handleCategoryIndexChange(index: number) {\n    if (index === 0) {\n      const newValue = {\n        ...tmpValue,\n        category: '',\n      };\n      setTmpValue(newValue);\n      setValidCheck(isValid(newValue));\n      return;\n    }\n    if (index - 1 < props.categories.length) {\n      const newValue = {\n        ...tmpValue,\n        category: props.categories[index - 1],\n      };\n      setTmpValue(newValue);\n      setValidCheck(isValid(newValue));\n      return;\n    }\n\n    // set text to empty\n    const newValue = { ...tmpValue, category: '' };\n    setTmpValue(newValue);\n    setValidCheck(isValid(newValue));\n    setShowText(true);\n  }\n\n  function handleCategoryNameChange(event: any) {\n    const newValue = {\n      ...tmpValue,\n      category: event.target.value,\n    };\n    setTmpValue(newValue);\n    setValidCheck(isValid(newValue));\n  }\n\n  const defaultFocus = React.useRef<any>(null);\n\n  const { category } = props.value;\n  const noCategories = props.categories.length <= 0;\n  const notInCategoryList =\n    category !== undefined && props.categories.indexOf(category) < 0;\n  const showDialogText = showText || noCategories || notInCategoryList;\n\n  return (\n    <div>\n      <Dialog\n        isOpen={props.isOpen}\n        description={props.descriptionText}\n        isValid={\n          isValidCheck.name && isValidCheck.comment && isValidCheck.category\n        }\n        onOpen={handleOpen}\n        onClose={handleClose}\n        title={props.title}\n        ok={props.okText}\n        another={props.anotherText}\n        cancel={props.cancelText}\n      >\n        <TextField\n          error={!isValidCheck.name}\n          inputRef={input => {\n            defaultFocus.current = input;\n          }}\n          margin=\"dense\"\n          label=\"Item name\"\n          placeholder=\"What's the name of the item?\"\n          type=\"text\"\n          onChange={handleNameChange}\n          fullWidth\n          value={tmpValue.name}\n          InputLabelProps={{\n            shrink: true,\n          }}\n        />\n        <TextField\n          error={!isValidCheck.comment}\n          margin=\"dense\"\n          label=\"Comment (optional)\"\n          placeholder=\"How many of this item?\"\n          value={tmpValue.comment}\n          onChange={handleCommentChange}\n          type=\"text\"\n          fullWidth\n          InputLabelProps={{\n            shrink: true,\n          }}\n        />\n        {!showDialogText && (\n          <Select\n            title=\"Category\"\n            value={tmpValue.category}\n            onChange={index => handleCategoryIndexChange(index)}\n            choices={['[None]', ...props.categories, '[Add Category]']}\n          />\n        )}\n        {showDialogText && (\n          <TextField\n            autoFocus={true}\n            error={!isValidCheck.category}\n            margin=\"dense\"\n            label=\"Category (optional)\"\n            placeholder=\"Which category?\"\n            value={tmpValue.category}\n            onChange={handleCategoryNameChange}\n            type=\"text\"\n            fullWidth\n            InputLabelProps={{\n              shrink: true,\n            }}\n          />\n        )}\n        {props.listOptions && tmpList !== undefined && (\n          <Select\n            title=\"List (optional, moves item to another list)\"\n            value={props.listOptions[tmpList]}\n            onChange={handleListChange}\n            choices={props.listOptions}\n          />\n        )}\n      </Dialog>\n    </div>\n  );\n}\n","import React from 'react';\nimport ItemDialog from './GenericDialog';\nimport { SimpleItem as Item } from '../../redux/state';\n\ninterface Props {\n  isOpen: boolean;\n  categories: string[];\n  onCommit: (value: Item) => void;\n}\n\nconst initialValue: Item = { name: '', comment: '', category: undefined };\n\nexport default function (props: Props) {\n  return (\n    <ItemDialog\n      value={initialValue}\n      title=\"Create Item\"\n      okText=\"Add\"\n      cancelText=\"Cancel\"\n      anotherText=\"Add Another\"\n      descriptionText=\"Pick the name for your new item.\"\n      {...props}\n    />\n  );\n}\n","import { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport Component from './AddDialog';\nimport { DialogType } from '../../redux/state';\nimport { SimpleItem as Item } from '../../redux/state';\n\nexport function extractCategories(state: RootState) {\n  const set: Set<string> = new Set();\n  state.lists.forEach(list =>\n    list.items\n      .filter(item => item.category !== undefined)\n      .forEach(item => set.add(item.category!))\n  );\n  return Array.from(set);\n}\n\nconst mapStateToProps = (state: RootState) => ({\n  isOpen: state.dialogState?.type === DialogType.ADD_ITEM,\n  categories: extractCategories(state),\n});\n\nconst connector = connect(mapStateToProps, {\n  onCommit: (value: Item) => value && actions.addItem(value),\n});\n\nexport default connector(Component);\n","import { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport Component from './EditDialog';\nimport { DialogType } from '../../redux/state';\n\nconst mapStateToProps = (state: RootState) => {\n  const { dialogState } = state;\n  if (\n    dialogState?.type === DialogType.EDIT_LIST &&\n    dialogState.index >= 0 &&\n    dialogState.index < state.lists.length\n  ) {\n    const initialValue = state.lists[dialogState.index].name;\n    return {\n      isOpen: true,\n      initialValue,\n    };\n  }\n  return {\n    isOpen: false,\n    initialValue: '',\n  };\n};\n\nconst connector = connect(mapStateToProps, {\n  onCommit: (value: string) => actions.editList(value),\n});\n\nexport default connector(Component);\n","import React from 'react';\nimport ListDialog from './GenericDialog';\n\ninterface Props {\n  isOpen: boolean;\n  initialValue: string;\n  onCommit: (value: string) => void;\n}\n\nexport default function (props: Props) {\n  return (\n    <ListDialog\n      value={props.initialValue}\n      title=\"Edit List\"\n      okText=\"Update\"\n      cancelText=\"Cancel\"\n      isEdit={true}\n      descriptionText=\"Pick the name for your list.\"\n      {...props}\n      onCommit={value => value && props.onCommit(value.name)}\n    />\n  );\n}\n","import { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport Component from './EditDialog';\nimport { DialogType } from '../../redux/state';\nimport { extractCategories } from './AddDialogContainer';\n\nconst mapStateToProps = (state: RootState) => {\n  const { dialogState, selectedList } = state;\n  if (\n    selectedList !== undefined &&\n    selectedList >= 0 &&\n    selectedList < state.lists.length &&\n    dialogState?.type === DialogType.EDIT_ITEM &&\n    dialogState.index >= 0 &&\n    dialogState.index < state.lists[selectedList].items.length\n  ) {\n    const initialValue = state.lists[selectedList].items[dialogState.index];\n    return {\n      isOpen: true,\n      initialValue,\n      listOptions: state.lists.map(({ name }) => name),\n      selectedList,\n      categories: extractCategories(state),\n    };\n  }\n  return {\n    isOpen: false,\n    initialValue: { name: '', comment: '' },\n    categories: [],\n    listOptions: undefined,\n    selectedList: undefined,\n  };\n};\n\nconst connector = connect(mapStateToProps, {\n  onCommit: (value: {\n    name: string;\n    comment: string;\n    listIndex?: number;\n    category?: string;\n  }) => value && actions.editItem(value),\n});\n\nexport default connector(Component);\n","import React from 'react';\nimport ListDialog from './GenericDialog';\nimport { SimpleItem as Item } from '../../redux/state';\n\ninterface Props {\n  categories: string[];\n  isOpen: boolean;\n  initialValue: Item;\n  onCommit: (value: Item) => void;\n}\n\nexport default function (props: Props) {\n  return (\n    <ListDialog\n      value={props.initialValue}\n      title=\"Edit List\"\n      okText=\"Update\"\n      cancelText=\"Cancel\"\n      descriptionText=\"Pick the name for your list.\"\n      {...props}\n    />\n  );\n}\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '../common/Dialog';\nimport CryptoJS from 'crypto-js';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport Ajv from 'ajv';\nimport configFile from './encrypted.json';\nimport { GoogleSheetSchema } from '../../redux/state';\nimport { logger } from '../common/Notifier';\n\ntype GoogleSheetState = {\n  spreadsheetId: string;\n  range: string;\n  clientId: string;\n  apiKey: string;\n};\n\ninterface Props {\n  // internal\n  isOpen: boolean;\n  //\n  spreadsheetId: string;\n  range: string;\n  clientId: string;\n  apiKey: string;\n  onCommit: (value: GoogleSheetState) => void;\n}\n\nfunction isValid(text: string) {\n  return text.trim().length > 0;\n}\n\nfunction decrypt(\n  password: string,\n  encrypted: string = configFile\n): GoogleSheetState {\n  const decrypted = CryptoJS.AES.decrypt(encrypted, password);\n  const obj = JSON.parse(decrypted.toString(CryptoJS.enc.Utf8));\n\n  const ajv = new Ajv({ allErrors: true });\n  const test = ajv.compile(GoogleSheetSchema);\n  if (test(obj)) {\n    return obj as GoogleSheetState;\n  }\n  console.error(`Decrypted object:\n  ${JSON.stringify(obj, null, 2)}\n  Failed validation:\n  ${JSON.stringify(test.errors, null, 2)}`);\n\n  throw Error('Invalid decrypt');\n}\n\nexport default function (props: Props) {\n  const [spreadsheetId, setSpreadsheetId] = React.useState(props.spreadsheetId);\n  const [range, setRange] = React.useState(props.range);\n  const [clientId, setClientId] = React.useState(props.clientId);\n  const [apiKey, setApiKey] = React.useState(props.apiKey);\n\n  function handleClose(commit: boolean) {\n    if (commit) {\n      // lazy...\n      const magicPrefix = 'secret:';\n      if (apiKey.startsWith(magicPrefix)) {\n        const result = decrypt(apiKey.slice(magicPrefix.length));\n        props.onCommit(result);\n        logger.info('Decrypted. Refresh required.');\n      } else {\n        props.onCommit({\n          spreadsheetId,\n          range,\n          clientId,\n          apiKey,\n        });\n      }\n    }\n  }\n\n  function handleOpen() {\n    setSpreadsheetId(props.spreadsheetId);\n    setRange(props.range);\n    setClientId(props.clientId);\n    setApiKey(props.apiKey);\n    if (defaultFocus.current) {\n      defaultFocus.current.focus();\n    }\n  }\n\n  const defaultFocus = React.useRef<any>(null);\n  const validApiKey = isValid(apiKey);\n  const validClientId = isValid(clientId);\n  const validRange = isValid(range);\n  const validSpreadsheetId = isValid(spreadsheetId);\n\n  const classes = useStyles();\n\n  return (\n    <Dialog\n      isOpen={props.isOpen}\n      isValid={validApiKey && validClientId && validRange && validSpreadsheetId}\n      onOpen={handleOpen}\n      onClose={handleClose}\n      title={'Setup Google Sheets'}\n      description={'Setup details for accessing GoogleSheets.'}\n      ok={'Done'}\n      cancel={'Cancel'}\n    >\n      <DialogContentText className={classes.helperText}>\n        GoogleSheets API access details. (Requires page refresh to reflect\n        changes.)\n      </DialogContentText>\n      <TextField\n        error={!validApiKey}\n        inputRef={input => {\n          defaultFocus.current = input;\n        }}\n        margin=\"dense\"\n        label=\"API Key\"\n        type=\"text\"\n        onChange={event => setApiKey(event.target.value)}\n        fullWidth\n        value={apiKey}\n        InputLabelProps={{\n          shrink: true,\n        }}\n      />\n      <TextField\n        error={!validClientId}\n        margin=\"dense\"\n        label=\"Client ID\"\n        type=\"text\"\n        onChange={event => setClientId(event.target.value)}\n        fullWidth\n        value={clientId}\n        InputLabelProps={{\n          shrink: true,\n        }}\n      />\n      <DialogContentText className={classes.helperText}>\n        Target spreadsheet and sheet name ids.\n      </DialogContentText>\n      <TextField\n        error={!validSpreadsheetId}\n        margin=\"dense\"\n        label=\"Spreadsheet ID\"\n        type=\"text\"\n        onChange={event => setSpreadsheetId(event.target.value)}\n        fullWidth\n        value={spreadsheetId}\n        InputLabelProps={{\n          shrink: true,\n        }}\n      />\n      <TextField\n        error={!validRange}\n        margin=\"dense\"\n        label=\"Sheet Name\"\n        type=\"text\"\n        onChange={event => setRange(event.target.value)}\n        fullWidth\n        value={range}\n        InputLabelProps={{\n          shrink: true,\n        }}\n      />\n    </Dialog>\n  );\n}\n\n// TODO: not really handling sign out (and sign back in)\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    helperText: {\n      marginTop: 20,\n      marginBottom: 0,\n    },\n  })\n);\n","import { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport Component from './SetupDialog';\nimport { DialogType } from '../../redux/state';\n\nconst mapStateToProps = (state: RootState) => ({\n  spreadsheetId: state.googleSheets?.spreadsheetId ?? '',\n  range: state.googleSheets?.range ?? '',\n  clientId: state.googleSheets?.clientId ?? '',\n  apiKey: state.googleSheets?.apiKey ?? '',\n  isOpen: state.dialogState?.type === DialogType.SETUP_GOOGLE_SHEETS,\n});\n\nconst connector = connect(mapStateToProps, {\n  onCommit: (value: RootState['googleSheets']) =>\n    actions.setGoogleSheetsDetails(value),\n});\n\nexport default connector(Component);\n","// colors for categories\nexport const COLORS = [\n  '#70d470',\n  '#ffdb66',\n  '#0076ff',\n  '#d5ff00',\n  '#ff937e',\n  '#007db5',\n  '#ff00f6',\n  '#90fb92',\n  '#7979fa',\n  '#f16d6d',\n  '#40f7f7',\n  '#ffa6fe',\n  '#6a826c',\n  '#ff029d',\n  '#fe8900',\n  '#7a4782',\n  '#7e2dd2',\n  '#85a900',\n  '#ff0056',\n  '#a42400',\n  '#00ae7e',\n  '#42af44',\n  '#683d3b',\n  '#bdd393',\n  '#00b917',\n  '#9e008e',\n  '#c28c9f',\n  '#ff74a3',\n  '#01d0ff',\n  '#004754',\n  '#e56ffe',\n  '#788231',\n  '#0e4ca1',\n  '#91d0cb',\n  '#be9970',\n  '#968ae8',\n  '#bb8800',\n  '#deff74',\n  '#00ffc6',\n  '#ffe502',\n  '#620e00',\n  '#008f9c',\n  '#98ff52',\n  '#7544b1',\n  '#b500ff',\n  '#00ff78',\n  '#ff6e41',\n  '#005f39',\n  '#6b6882',\n  '#5fad4e',\n  '#a75740',\n  '#a5ffd2',\n  '#ffb167',\n  '#009bff',\n  '#e85ebe',\n];\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { actions, RootState } from '../../redux/store';\nimport List, { Props as ListProps } from '../common/List';\nimport { Item } from '../../redux/state';\nimport { extractCategories } from './AddDialogContainer';\nimport { COLORS } from '../common/Colors';\n\nconst defaultSorter = (a: Item, b: Item) =>\n  Number(!a.enabled) - Number(!b.enabled);\n\nconst alphabeticSorter = (a: Item, b: Item) => {\n  const defaultResult = defaultSorter(a, b);\n\n  if (defaultResult !== 0) {\n    return defaultResult;\n  }\n\n  const { name: aName } = a;\n  const { name: bName } = b;\n  if (aName === undefined || bName === undefined) {\n    return Number(aName === undefined) - Number(bName === undefined);\n  }\n  return aName.localeCompare(bName);\n};\n\nconst categorySorter = (a: Item, b: Item) => {\n  const defaultResult = defaultSorter(a, b);\n\n  if (defaultResult !== 0) {\n    return defaultResult;\n  }\n\n  const { category: aCategory } = a;\n  const { category: bCategory } = b;\n  if (aCategory === undefined || bCategory === undefined) {\n    return Number(aCategory === undefined) - Number(bCategory === undefined);\n  }\n  return aCategory.localeCompare(bCategory);\n};\n\nfunction buildMapper(state: RootState) {\n  const { categoryColorMapper } = state;\n\n  // use user-defined color mapper\n  if (categoryColorMapper !== undefined) {\n    return (category: string | undefined) => {\n      if (category === undefined) {\n        return undefined;\n      }\n      return categoryColorMapper[category];\n    };\n  }\n\n  // use default color array\n  const categories = extractCategories(state);\n  return (category: string | undefined) => {\n    if (category === undefined) {\n      return undefined;\n    }\n    const index = categories.indexOf(category);\n    if (index !== -1 && index < COLORS.length) {\n      return COLORS[index];\n    }\n    return undefined;\n  };\n}\n\nconst mapToListState = (state: RootState) => {\n  const index = state.selectedList;\n  const sorter =\n    state.sortMode === 'categories'\n      ? categorySorter\n      : state.sortMode === 'alphabetic'\n      ? alphabeticSorter\n      : defaultSorter;\n\n  if (index !== undefined) {\n    const extractColor =\n      state.categoryMode === 'color' ? buildMapper(state) : () => undefined;\n\n    return {\n      lists: state.lists[index].items\n        .map((item, index) => ({\n          ...item,\n          index,\n        }))\n        .sort(sorter),\n      categoryMode: state.categoryMode,\n      clickEnabled: state.itemClick,\n      extractColor,\n    };\n  }\n  return { lists: [], clickEnabled: state.itemClick };\n};\n\nconst dispatchToProps = {\n  onDelete: (index: number) => actions.deleteItem(index),\n  onEdit: (index: number) => actions.openEditItemDialog(index),\n  onClick: (index: number) => actions.toggleItem(index),\n  toggleClick: () => actions.toggleItemClick(),\n};\n\ntype Props = Omit<ListProps, 'actions' | 'swipeRight'> & {\n  onEdit: (index: number) => void;\n  toggleClick: () => void;\n};\n\nfunction ListWithContextMenu(props: Props) {\n  return (\n    <List\n      {...props}\n      swipeRight={true}\n      actions={[\n        [\n          {\n            label: 'Edit',\n            action: (index: number) => props.onEdit(index),\n          },\n        ],\n        [\n          {\n            label: 'Delete',\n            action: (index: number) => props.onDelete(index),\n          },\n        ],\n      ]}\n    />\n  );\n}\n\nconst connector = connect(mapToListState, dispatchToProps);\nexport default connector(ListWithContextMenu);\n","import { ConnectedProps, connect } from 'react-redux';\nimport React from 'react';\nimport AppBar from './app-bar/AppBarContainer';\nimport List from './shopping-list/ListContainer';\nimport AddListDialog from './shopping-list/AddDialogContainer';\nimport AddItemDialog from './item-list/AddDialogContainer';\nimport EditListDialog from './shopping-list/EditDialogContainer';\nimport EditItemDialog from './item-list/EditDialogContainer';\nimport SetupGoogleSheetsDialog from './google-sheets/SetupDialogContainer';\nimport ItemList from './item-list/ListContainer';\nimport { RootState } from '../redux/store';\nimport Notifier from './common/Notifier';\n\nconst connector = connect((state: RootState) => ({\n  isListSelected: state.selectedList !== undefined,\n}));\n\ntype Props = ConnectedProps<typeof connector>;\n\nfunction Main(props: Props) {\n  const children: JSX.Element[] = [];\n  const isItemView = props.isListSelected;\n  if (isItemView) {\n    children.push(<ItemList key=\"item-list\" />);\n    children.push(<AddItemDialog key=\"item-add-dialog\" />);\n    children.push(<EditItemDialog key=\"item-edit-dialog\" />);\n    children.push(<SetupGoogleSheetsDialog key=\"setup-google-sheets-dialog\" />);\n  } else {\n    children.push(<List key=\"list\" />);\n    children.push(<AddListDialog key=\"list-add-dialog\" />);\n    children.push(<EditListDialog key=\"list-edit-dialog\" />);\n    children.push(<SetupGoogleSheetsDialog key=\"setup-google-sheets-dialog\" />);\n  }\n\n  return (\n    <div\n      style={{\n        flex: 1,\n        // border: '1px solid blue',\n        display: 'flex',\n        flexFlow: 'column',\n        height: '100%',\n      }}\n    >\n      <AppBar />\n      <Notifier />\n      {children}\n    </div>\n  );\n}\n\nexport default connector(Main);\n","import React from 'react';\nimport Main from './components/Main';\nimport {\n  // TODO: update version once warning is fixed, see: https://github.com/mui-org/material-ui/issues/13394\n  unstable_createMuiStrictModeTheme as createMuiTheme,\n  Theme,\n  makeStyles,\n  createStyles,\n  ThemeProvider,\n} from '@material-ui/core/styles';\n\nconst theme = createMuiTheme({\n  props: {\n    MuiButtonBase: {\n      disableRipple: true,\n    },\n  },\n  transitions: {\n    // Disable transitions since they make UI feel slow\n    create: () => 'none',\n  },\n});\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    app: {\n      minHeight: '100vh',\n      height: '100%',\n      display: 'flex',\n      overflow: 'hidden',\n      flexDirection: 'column',\n    },\n  })\n);\n\nexport default function () {\n  const classes = useStyles();\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div className={classes.app}>\n        <Main />\n      </div>\n    </ThemeProvider>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './shopper/App';\nimport { store } from './shopper/redux/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\nimport { importText, exportText } from './shopper/importer';\nimport { logger } from './shopper/components/common/Notifier';\n\nfunction isDebug(): boolean {\n  const url = new URL(window.location.href);\n  const param = url.searchParams.get('debug');\n  return Boolean(param);\n}\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  const url = new URL(window.location.href);\n  const text = url.searchParams.get('text');\n  if (text !== null) {\n    const items = importText(text);\n    if (navigator?.clipboard?.writeText) {\n      const text = exportText(items);\n      navigator.clipboard.writeText(text);\n      logger.info(`Copied ${items.length} items to clipboard`);\n    } else {\n      logger.error('ERROR: denied use of browser clipboard');\n    }\n  }\n});\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nif (isDebug()) {\n  console.log('No service worker enabled.');\n  serviceWorker.unregister();\n} else {\n  serviceWorker.register();\n}\n"],"sourceRoot":""}